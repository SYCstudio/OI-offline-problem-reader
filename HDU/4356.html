<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Three Eggache God</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU4356. Three Eggache God</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：4000/2000 MS (Java/Others)</span> <span class="ui label">时间限制：65536/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Alpheus has n monsters,their heights are A<sub>1</sub>,A<sub>2</sub>,A<sub>3</sub>....A<sub>n</sub>. God Kufeng has n sons,their heights are 1,2,3....n.<br>One day, Our daredevil God Kufeng wants to challenge Alpheus. He sends his n sons to fight with Alpheus's n monsters ,the i-th son fighting with the i-th monster. During one challenge,if the i-th son's height is equal or greater than the i-th monster's height,the i-th son will get one score for his father,else,he'll get nothing.<br>Since Alpheus is strong enough to accept an infinity number of challenges,God Kufeng can challenge Alpheus again and again,but he has to change his son's order after every challenge,and the same permutation can not appear more than once.(that is,God Kufeng has n! times to challenge Alpheus).<br>Now,God Wu--the god of universe,wants to make things difficult to Kufeng.He has n sons too,their heights are W<sub>1</sub>,W<sub>2</sub>,W<sub>3</sub>....W<sub>n</sub>(it is a permutation of 1,2,3.....n),God Wu said to Kufeng: Only when the lexicographic order of your sons' heights is bigger than my son's,you can challenge my lovely Alpheus!<br>Question:What is the total score God Kufeng can get?Output the answer mod 1000000007.<br>Note:<br>Alpheus will never change his monster's order,God Wu will never change his son's order.<br>For two permutation A and B,if A<sub>i</sub>=B<sub>i</sub> for all i(1&lt;=i&lt;=n),we say A=B.else,we get the smallest i that A<sub>i</sub>!=B<sub>i</sub>,if A<sub>i</sub>&gt;B<sub>i</sub>,we say A's lexicographic order is bigger than B,otherwise,B is bigger than A.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">First,there is an integer T(T&lt;=20),the number of test cases.<br>For every case,there are three lines.<br>The first line is an integer n(1&lt;=n&lt;=2000),the number of sons of God Kufeng.<br>The second line has n integers,W<sub>1</sub>,W<sub>2</sub>,W<sub>3</sub>.....W<sub>n</sub>,the heights of God Wu's sons.(we guarantee that W<sub>1</sub>,W<sub>2</sub>,W<sub>3</sub>.....W<sub>n</sub> is a permutation of 1,2,3....n).<br>The third line also has n integers, A<sub>1</sub>,A<sub>2</sub>,A<sub>3</sub>....A<sub>n</sub>(1&lt;=A<sub>i</sub>&lt;=n),the heights of Alpheus's monsters.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For every test case,output one line,&quot;Case #k: ans&quot;,where k is the case number,counting from 1,ans is the total score God Kufeng can get(mod 1000000007).</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2
3
3 1 2
1 2 3
3
3 2 1
1 1 1</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case #1: 2
Case #2: 0</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2012+Multi-University+Training+Contest+6&source=1&searchmode=source"> 2012 Multi-University Training Contest 6 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>