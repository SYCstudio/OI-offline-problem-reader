<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Network</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU3027. Network</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/10000 MS (Java/Others)</span> <span class="ui label">时间限制：98304/98304 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">There is a network which is a completely binary tree. In the network, there are 2N users numbered from 1, 2, 3, 4, ... 2N, which are the leaves in the network-tree. For example, Figure 1 is a network-tree. In the tree, there are 8 users (leaf nodes) and 7 transmitters (gray nodes).<br><center><img style='max-width:100%;' src=./data/images/exe3027-1.JPG></center><br>Using network-tree means that you have to pay a cost for it. The charging way is so interesting, named &quot;pair charging&quot;. The cost you must pay is the sum of cost from every pair of user i and user j ( 1 ≤ i &lt; j ≤ 2N). Every user can choose mode A or mode B to pay for the charge.<br><br>For every two users i, j (1 ≤ i &lt; j ≤ 2N), first find their LCA (The Least Common Ancestors): Transmitter P. Then count the number of mode A users in the tree of ROOT transmitter P, so do mode B.<br><br>Next, let's name the number nA and nB and at last charge the cost.<br><br>f[i][j] is the flow between user i and user j.<br><br>The charging way is followed:<br><center><img style='max-width:100%;' src=./data/images/exe3027-2.JPG></center><br>At first, every user has an initial mode, A or B. However, they want to reduce the cost, so a part of them would change the mode from A to B, or from B to A. Every change will have an extra cost. If user i changes his mode, he will pay Ci cost.<br><br>Now, you should find the minimum cost, that is, the sum of the cost having to pay for and the extra cost of changing mode. </div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">First line, an integer N (N ≤ 10).<br><br>Sencond line, 2N integers, ith integer stands for ith user's initial mode. 0 is mode A, 1 is mode B.<br><br>Third line, 2N integers, ith integer stands for Ci, the cost that ith user changes his mode. (0 ≤ Ci ≤ 500 000)<br><br>Next 2N - 1 line, describe the flow of every pair of users. The i + 3 th line's (in the whole input) j row's integer standing for the f[i][j + i]. (1 ≤ i ≤ 2^N ,1 ≤ j ≤ 2^N - i, 0 ≤ f[i][j] ≤ 500). </div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Only a single integer, standing for the minimum cost above.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2 
1 0 1 0 
2 2 10 9
10 1 2 
2 1 
3</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">8

Explanation: Changing the user 1's mode from B to A will minimumize the cost. </div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2009+Multi-University+Training+Contest+6+-+Host+by+WHU&source=1&searchmode=source"> 2009 Multi-University Training Contest 6 - Host by WHU </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>