<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Molecular Weight Calculator </title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU2695. Molecular Weight Calculator </h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：60000/20000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Even though not good at memorizing, Alex is fond of Chemistry. When solving problems, he always needs to calculate the  <br>molecular weight and quantity of each kind of elements. Lazy Alex hates that and turns to you for help. <br><br>Your task is: <br>Given a chemical formula, calculate its molecular weight and quantity of each kind of elements. <br><br>The atom is represented by either a single capital letter or a capital letter and a lower case letter. E.g. C, Ca, H, O. Formulas  <br>may contain brackets: '(',')', which is always followed by the quantity of that atomic mission. The number after an atom or a  <br>bracket represents the quantity of that atomic mission. E.g. CH4, CaCO3, Fe(SCN)3. Brackets may be nested. </div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The input consists of multiple test cases. The first line of input contains an integer T, which is the number of test cases. <br><br>Each test case is on several lines. The first line contains an integer, N, indicating the quantity of known elements. <br>Each of the following n lines is consisting of a element description, start with a element name and followed by the weight  <br>W (floating point number), separated by a space. <br>The (n+1)-th line consists an integer M, indicating the quantity of formulas. <br>Each of the following M lines is consisting of a formula. <br><br>[Technical Specification] <br>1.T is an integer, and T &lt;=10.  <br>2.N is an integer, and 1 &lt;= N &lt;= 200. <br>3.W is a floating point number with two fractional digits, and 1 &lt;= W &lt;= 400. <br>4.M is an integer, and 1 &lt;= M &lt;= 100. <br>5.Numbers in the formula is always in the range of [2,9] inclusive. <br>6.The formula?s length does not exceed 500. <br>7.There's no blank line between two test cases. </div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each formula in each test case, print a single line as the format below. <br>Format: <br>Weight Element[quantity] Element[quantity] Element[quantity] ... <br>e.g. 44.00 C[1] O[2] <br>The element is ordered as they were in the input. Display all the elements except for those not in the formula. The weight is  <br>rounded to two fractional digits. Notice that the answer may be very large. <br>There's no whitespace at the end of each line. </div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1 
7 
H 1.00 
C 12.00 
O 16.00 
N 14.00 
S 32.00 
Ca 40.00 
Fe 56.00 
4 
CO2 
CH4 
CaCO3 
Fe(SCN)3 </code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">44.00 C[1] O[2] 
16.00 H[4] C[1] 
100.00 C[1] O[3] Ca[1] 
230.00 C[3] N[3] S[3] Fe[1] </div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=The+4th+Baidu+Cup+Central+China+Invitational+Programming+Contest&source=1&searchmode=source"> The 4th Baidu Cup Central China Invitational Programming Contest </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>