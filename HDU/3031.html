<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>To Be Or Not To Be</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU3031. To Be Or Not To Be</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：6000/3000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">That's a question. Now Happy (Xi Yangyang) has been caught by Wolffy (Hui Tailang). As Wolffy is busy preparing the big meal, a good idea comes to Happy. He proposes a game that only Wolffy had won, he can eat Happy. Wolffy always believes he is the cleverest one, so they reach a consensus. And they both agree with Wolnie (Hong Tailang) when the referee. A theater will be beat to die by Wolnie's pan.<br><center><img style='max-width:100%;' src=./data/images/exe3031-1.JPG></center><br><br>The game is defined as follow.<br><br>There are multiple test cases.<br><br>In each case there are R (R &lt; 10) rounds of the game, R is an odd number to guarantee that there must be a winner in the end.<br><br>In each round: There is a pile of n (10 &lt;= n &lt;= 200) Special-cards and m (1 &lt;= m &lt;= 100) piles of Point-card on the table. The Point-card piles are ordered from 1 to m. Wolffy and Happy take turns to get one card from the top of Special-cards pile. Wolffy always takes first in the game. When all the Special-cards have been taken, the round is over and the one with more cards in the hands gains one point. If there is a tie, Wolffy gains one point.(Wolffty and Happy both have 0 point before the game).<br><br>There are 5 kinds of Special-cards besides the Point-card in the game.<br><br>0) Point-card: a card with a point X (1 &lt;= X &lt;= 2000000).<br><br>1) Challenge-card: no matter who takes this card, they both take one card with the maximum point from their own hands. After a comparison, if Happy's card has a larger point, He takes all the Wolffy's in-hands cards, vice versa; If there is a tie no more operation.<br><br>2) Loss-card: the one who takes this card, He must throw a card with the maximum point.<br><br>3) Add-card: a card with P point, the one who gets this card will make the card with maximum point P point larger, i.e. if a Point-card with X point is the maximum, its point will change to X + P. An Add-card can only work on one Point-card.<br><br>4) Exchange-card: a card with Q point. The one who gets this card must change one maximum-point card's point to Q.<br><br>5) Take-card: a card with a integer K, indicates one can get the all the cards of Kth Point-card pile. In one round no two Take-card have the same K.<br><br>You can assume that when one gets the Loss-card, Add-card, Exchange-card, He has at least one card in the hands, when one gets a Challenge-card, they both have at least one card in the hands.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Input<br><br>For each test case, the first line of input is an integer R, indicates the number of rounds:<br><br>Line 2: two integers n indicates the number of Special-cards, m indicates the number of Point-card piles.<br><br>Line 3: a line of m integers. The ith number Pi (1 &lt;= Pi &lt;= 10000)indicates the number cards of ith Point-card pile.<br><br>For the next m lines, ith line contains Pi numbers indicate every Point-card's point of ith Point-card pile.<br><br>The next n lines, in each line, there are five kinds of input, indicate Special-cards by the order of &quot;from top to bottom&quot;.<br><br>1) T K: indicates one gets a Take-card, and He can get Kth Point-card pile(1 &lt;= K &lt;= m).<br><br>2) C: indicates one gets a Challenge card.<br><br>3) L: indicates one gets a Loss card.<br><br>4) A P: indicates one gets an Add card with P point (1 &lt;= P &lt;= 30).<br><br>5) E Q: indicates one gets an Exchange card with Q point (1 &lt;= Q &lt;= 2000000).</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each round you should print A:B in a line. A indicate the number of left cards of Wolffy, B indicates the number of left cards of Happy. At the end of game, if Wolffy gains more points, print &quot;Hahaha...I win!!&quot;, else print &quot;I will be back!!&quot;.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3
5 3
3 3 3
10 11 2
7 4 12
4 2 9
T 1
T 2
A 7
T 3
C
6 3
2 2 2
1 4
5 2
4 2
T 2
T 1
L
A 2
T 3
C
5 3
2 2 2
1 3
4 2
5 2
T 2
T 1
E 3
A 1
L</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">9:0
0:5
1:2
I will be back!!</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2009+Multi-University+Training+Contest+13+-+Host+by+HIT&source=1&searchmode=source"> 2009 Multi-University Training Contest 13 - Host by HIT </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>