<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Keep In Touch</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5807. Keep In Touch</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：4000/2000 MS (Java/Others)</span> <span class="ui label">时间限制：262144/131072 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">There are $n$ cities numbered with successive integers from $1$ to $n$ in Byteland. Also, there are $m$ one-way roads connecting the cities. The starting point of the $i$-th road is $u_i$ while the ending point is $v_i$.<br><br>There are $3$ spies : 007, 008 and 009. They are going to start $q$ secret missions.<br><br>During each mission, they may be in three different cities, and they contact each other using interphones. The radio frequency of the $i$-th city is $w_i$. Two spies can contact with each other if and only if the absolute value of the difference of radio frequency between the cities where they are in is no more than $K$. At each moment, three spies must choose a road and go to another city. The time for traveling each road is only a unit of time.<br><br>They can choose to end the mission in any city, even in the city where they started the mission. But they are not allowed to end mission in the middle of the roads. Now they want to know, for each mission whose start points are given, what's the number of possible ways, during which they can contact with each other at any moment when they are not on roads?<br><br>Two ways are considered different if and only if there exists at least one spy at different cities on the same moment.<br><br>Note : $3$ spies must end the mission at the same time.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first line of the input contains an integer $T$ $(1\leq T\leq 10)$, denoting the number of test cases.<br><br>In each test case, the first line of the input contains four integers $n$ $(1\leq n\leq 50),m(0\leq m\leq \frac{n(n-1)}{2}),K(0\leq K\leq 10^9),q(1\leq q\leq 125000)$, denoting the number of cities, the number of roads, the upper limit of interphone and the number of missions.<br><br>The second line of the input contains $n$ integers $w_1, w_2, ..., w_n$ $(1\leq w_i\leq 10^9)$, denoting the radio frequency of the $i$-th city.<br><br>Each of the next $m$ lines contains two integers $u_i,v_i$ $(1\leq u_i &lt; v_i\leq n)$, denoting an one-way road. There are no multiple edges in the graph.<br><br>Each of the next $q$ lines contains three integers $x,y,z(1\leq x,y,z\leq n)$, denoting the starting point of the three spies in each mission. You can assume that there are at least one possible way in each mission.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each test case, print $q$ lines with one integer per line. For each mission, print the number of possible ways modulo $998244353$.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1
4 4 2 10
8 8 4 1
1 3
1 4
2 3
2 4
1 1 1
1 1 2
1 2 1
1 2 2
2 1 1
2 1 2
2 2 1
2 2 2
3 3 3
4 4 4</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3
3
3
3
3
3
3
3
1
1</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=BestCoder+Round+%2386&source=1&searchmode=source"> BestCoder Round #86 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>