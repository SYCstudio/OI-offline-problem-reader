<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Arithmetic of Bomb II</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU6145. Arithmetic of Bomb II</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：30000/15000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">众所周知，度度熊非常喜欢数字。<br><br>它最近在学习小学算术，沉迷于计算A+B中不能自拔。<br><br>但是这回的算术题可并不简单，由于含有表示bomb的#号，度度熊称之为 Arithmetic of Bomb。<br><br><center><img style='max-width:100%;' src=./data/images/C777-1002-1.jpg></center><br><br>Arithmetic of Bomb的目的与普通算术一样，就是计算一些Bomb Expression的结果。比如，”1-2+3”的结果为2。然而，bomb，也就是#号，会展开一些普通表达式，这会导致需要计算的式子超出了度度熊所能理解的范畴。比如”(1-2+3)#(3)”表示”1-2+3”出现了3次，将会被展开为”1-2+31-2+31-2+3”。<br><br>为了方便理解，下面给出了Bomb Expression的BNF表示。<br><br>```<br>&lt;bomb expression&gt; := &lt;bomb term&gt; | &lt;bomb expression&gt; &lt;bomb term&gt;<br>&lt;bomb term&gt; := &lt;bomb statement&gt; | '(' &lt;bomb statement&gt; ')' '#' '(' &lt;number&gt; ')'<br>&lt;bomb statement&gt; := &lt;bomb element&gt; | &lt;bomb statement&gt; &lt;bomb element&gt;<br>&lt;bomb element&gt; := &lt;digit&gt; | '+' | '-' | '*'<br>&lt;normal expression&gt; := &lt;norm term&gt; | &lt;normal expression&gt; '+' &lt;norm term&gt; | &lt;normal expression&gt; '-' &lt;norm term&gt;<br>&lt;norm term&gt; := &lt;number&gt; | &lt;norm term&gt; '*' &lt;number&gt;<br>&lt;number&gt; := &lt;digit&gt; | &lt;non-zero-digit&gt; &lt;number&gt;<br>&lt;digit&gt; := '0' | &lt;non-zero-digit&gt;<br>&lt;non-zero-digit&gt; := '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9'<br><br>```<br><br><br>请先将Bomb Expression中所有的#号展开，使其成为Normal Expression（题目的输入保证展开后是一个合法的Normal Expression），再来计算这个表达式的结果。</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">第一行为T，表示输入数据组数。<br><br>每组数据包含一个Bomb Expression。<br><br>●1≤T≤50<br><br>●1≤length(Bomb Statement)≤10<br><br>●1≤length(Number in Bomb term)≤10<br><br>●1≤length(Bomb Expression)≤300 000</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">对每组数据输出表达式的结果，结果对 1 000 000 007 取模。</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">6
1-2+3
(1-2+3)#(3)
(1)#(3)
(1+)#(2)1
(2*3+1)#(2)
(2)#(2)1+1(2)#(2)</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2
60
111
3
43
343</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2017%B0%D9%B6%C8%D6%AE%D0%C7%B3%CC%D0%F2%C9%E8%BC%C6%B4%F3%C8%FC+-+%B8%B4%C8%FC&source=1&searchmode=source"> 2017百度之星程序设计大赛 - 复赛 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>