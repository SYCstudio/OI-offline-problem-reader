<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Play a game</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5529. Play a game</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：8000/4000 MS (Java/Others)</span> <span class="ui label">时间限制：262144/262144 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Andy and Andrew are very smart guys and they like to play all kinds of games in their spare time. The most amazing thing is that they always find the best strategy, and that's why they feel bored again and again. They just invented a new game, as they usually did.<br><br>At the beginning of the game, they write down one string $S=s_1s_2s_3 \ldots  s_k$, and then they take turns(Andy first) to either:<br><br>1. Erase the leftmost character from $S$, that is, $S=s_2s_3s_4 \ldots s_k$. <br>2. Erase the rightmost character from $S$, that is, $S=s_1s_2s_3 \ldots s_{k-1}$.<br><br>Whenever $S$ is empty or $S \in A$ ($A$ is a given list of strings), the player which plays next loses the game.<br><br>For example, let $S=dzxx$ and $A=\{z,dz\}$. If Andy erases 'x' then Andrew can erase another 'x', because $S=dz$ and $dz$ is in $A$, Andy, the next player, loses. Otherwise, Andy erases 'd', and then Andrew can erase 'z' result in a losing position for Andy.<br><br>You are given a string $T=t_1t_2t_3\ldots t_n$ and a list of string $A=\{a_1,a_2,\ldots,a_m\}$. Your task is to find who is the winner if $S$ is some substring of $T$. Andy and Andrew play so many times so you need to answer multiple queries.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first line contains an integer $t$ indicating the total number of test cases. The following lines describe a test case.<br><br>The first line of each case contains three integers $n$, $m$, $q$, the length of $T$, the size of $A$, and the number of queries.The second line contains a string, representing $T$. Next $m$ lines, each line consists of a string, representing $a_i$. Next $q$ lines, each line consists of two integers $l,r$, representing a query that you should output who is the winner if $S=t_lt_{l+1} \ldots t_{r}$.<br><br>$1 \le t \le 21$<br>$1 \le n, q \le 40000$<br>$1 \le m \le 10000$<br>$1 \le \sum\limits_{i=1}^{m}|a_i| \le 10000$<br>$1 \le l \le r \le n$<br>$T$ and strings in $A$ consist of lowercase English letters.<br>There are at most 6 test cases with $n&gt;5000$.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each query, if Andy wins, print &quot;1&quot; (without the quotes) on a single line, otherwise print &quot;0&quot; (without the quotes) on a single line.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1
10 4 10
zzzabcdzxx
a
z
dz
abcd
1 3
1 4
3 6
3 7
3 8
3 9
4 4
4 5
5 5
7 10</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">0
1
1
1
0
1
0
1
1
0</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2015ACM%2FICPC%D1%C7%D6%DE%C7%F8%B3%A4%B4%BA%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%B6%AB%B1%B1%CA%A6%B4%F3%A3%A9&source=1&searchmode=source"> 2015ACM/ICPC亚洲区长春站-重现赛（感谢东北师大） </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>