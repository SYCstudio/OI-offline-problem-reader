<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Message</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU2901. Message</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">When little Sascha grew up, she lost her bad habit of pronouncing words in ways that were most easy for her, but did not always match the correct-pronunciation. However, she never lost the linguistic creativity she used to show as a little girl. When the Earth Allied Forces (EAF) discovered she also had brilliant mathematical insights and a knack for puzzles and secret messages,she was immediately offered the position of Head of the EAF Intelligence Department.<br><br> Sascha's current task is interpreting intercepted internal messages of the hostile Mars Feder-ation. Although Martian messages always consist of just one word, her task turns out not to be easy, as two factors in uence the content of the intercepted message: <br><br>a) Extraterrestrial environment conditions are so bad that errors can occur in intercepted messages, causing them to be quite obfuscated compared to the originally sent text. If such errors occur, the erroneous characters will be characters from the Martian alphabet, just as the original characters. <br><br>b) Furthermore, linguistic characteristics play an important role. In Martian, there are relations between two subsequent characters: for a given character, some characters are more likely predecessors than others (note that something similar occurs in English: for example, a `h' in a word will more likely have been preceded by a 't' than by a `q'). <br><br>Fortunately, probabilities that a received character y actually was sent as an original Martian character x is known for all alphabet characters, as well as the probabilities that a certain character xi occurs in a clean Martian word if it was preceded by a Martian character x(i-1).<br><br>Given all these probabilities, Sascha wants to  nd the so-called maximum likelihood text for a received message, which is the most likely message the Martians originally sent. As senior pro-grammer in the EAF Intelligence Department, you must write a program for her, achieving this goal for several intercepted messages in several local Martian dialects. <br><br>To give a simple example, consider a local Martian alphabet only consisting of the characters ‘a’ and ‘b’ and let the receiving error probabilities and character succession probabilities be as shown in Table 2. If the intercepted message just consists of an `a', this can either originally have been an `a' or a `b'. With no previous characters available, only the error probabilities are considered: it then turns out that the maximum likelihood message is an `a' as well, with probability 0.9.<br><br><center><img style='max-width:100%;' src=./data/images/contest199-b.JPG></center><br><center>Table 2: Example Receiving Error Probabilities (left) and Character Succession Probabilities(right).</center><br><br>To extend the example, if the intercepted message was `ab', we also need the character succession probabilities. The probability that the original message was `aa' is<br><br> <center>p(received `a' indeed was originally sent as `a') </center><br><center>*p(received 'b' was originally sent as `a') *p(character `a' succeeds previous `a')</center><br> <center>= 0.9 * 0.1 * 0.8:</center><br><br>Similarly, the probability that the original message was `bb', `ab' or `ba' are 0.1 * 0.9 * 0.95, 0.9* 0.9 * 0.05 and 0.1 * 0.1 *0.2, respectively. Hence, the maximum likelihood message now is `bb'. In all cases asked for, there will always be a unique maximum likelihood message.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The _rst line of input consists of the integer number n, the number of test cases;<br><br>Then, for each test case:<br><br>- An integer number a (0 &lt; a &lt; 30), which is the number of characters in the local Martian alphabet; <br><br>- A line containing the a unique characters c1; c2; ..... ; ca of the local Martian alphabet,separated by single spaces. Whitespace characters will not occur in the alphabet;<br>-  a lines, specifying receiving error probabilities for the a alphabet characters in the orderin which they were presented. The ith line corresponds to the error probabilities for the original alphabet character ci and contains:<br><br>*  a floating point numbers ei1; ei2; .....; eia, separated by single spaces. Number eij(0 &lt;=eij &lt;= 1) indicates the probability that an observed character cj originally was sent as the character ci (hence <img style='max-width:100%;' src=./data/images/contest199-b-1.JPG>);  <br><br>- a lines, specifying character succession probabilities for the a alphabet characters in theorder in which they were presented. The ith line corresponds to the character succession probabilities for cases where the original alphabet character ci was the immediate predecessor and contains: <br><br>*  a  floating point numbers si1; si2; .... ; sia, separated by single spaces. Number sij indicates the probability that a certain character cj has character ci as immediate predecessor (hence <img style='max-width:100%;' src=./data/images/contest199-b-2.JPG>  ); <br><br>- An integer number w (0 &lt; w &lt; 50), indicating the number of intercepted messages in the local Martian alphabet specified; <br><br>- Then, for each intercepted message:<br><br>-  A line containing the intercepted message. These messages are non-empty, case-sensitive and will not exceed 300 characters in length.<br><br>Given _oating point numbers never have more than 10 decimal numbers following the separator  '.'</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each message in each test case, the output will consist of a single line with a single string: the maximum likelihood original Martian message given the intercepted message.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1
2
a b
0.9 0.1
0.1 0.9
0.8 0.05
0.2 0.95
2
a
ab</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">a
bb</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=BAPC+2008&source=1&searchmode=source"> BAPC 2008 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>