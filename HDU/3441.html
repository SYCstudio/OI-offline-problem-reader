<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Rotation</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU3441. Rotation</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">As you know, AekdyCoin loves games.One day，he got a small square board such as the one in Figure 1，the length of side is A (Here A is an integer!).<center><img style='max-width:100%;' src=./data/images/3441-1.jpg></center> Now AekdyCoin has C different color, he uses these color to paint the A * A board above. You could see a possible painted board in Figure 2.<br>If one board could be rotated to another board (both painted), we consider them as the same, just as you could see in the figure 3。<center><img style='max-width:100%;' src=./data/images/3441-2.jpg></center> Now，AekdyCoin cut the A*A board into A*A small square boards whose length of side is exactly 1.<center><img style='max-width:100%;' src=./data/images/3441-3.jpg></center><center><img style='max-width:100%;' src=./data/images/3441-4.jpg></center>Then AekdyCoin combine some squares to some new B*B squares(as many as possible)，here :<br>B * B * K + 1 = A * A, (K &gt;= 0)<br>in the figure 5, there are two possible ways, B = 1 or B = 2<br>Then AekdyCoin connect the left one 1 * 1 square to other B * B square(s), as in the figure 6 <center><img style='max-width:100%;' src=./data/images/3441-5.jpg></center> But all the state you get if you rotate any B * B square(s) or rotate the figure around the left one 1 * 1 square are considered as the same. For example, all the states in Figure 7 are same.<center><img style='max-width:100%;' src=./data/images/3441-6.jpg></center> Now AekdyCoin want to know the unique state he could get if he try any possible combination .(That means he will try all possible B)</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first line is an integer T indicates the number of the cases. ( T &lt;= 1000)<br>Then T lines<br>A C<br>Indicate the value of A and the kind of colors AekdyCoin has. (1&lt;=A,C&lt;=10^9)<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Output a single integer indicates the remainder of the answer after divided by 1000000007</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2
2 7
3 2</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case 1: 833
Case 2: 114</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2010+ACM-ICPC+Multi-University+Training+Contest%A3%A81%A3%A9%A1%AA%A1%AAHost+by+FZU&source=1&searchmode=source"> 2010 ACM-ICPC Multi-University Training Contest（1）——Host by FZU </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>