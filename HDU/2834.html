<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Girl Friend II</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU2834. Girl Friend II</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">After a long time of effort, RoBa still keeps single. He finds that all the girls are so hard to understand. They can become happy in one minute, and then get angry in the next. What’s more, what they do is usually quite different from what they think! <br><br>As an algorithmic geek, RoBa builds a probability model to study a girl’s behavior. That is, there are N kinds of inner states for one girl. At the beginning, the girl can be at state i with probability Si. Then at every minute after that, the girl’s state can be changed from state i to state j with probability Pij. Of course, S1+S2+…+SN = 100 (in percent), and for all the i, Pi1+Pi2+…+PiN=100<br><br>And that’s still not practical enough. RoBa knows that he cannot see the inner state of a girl directly, but can only see her outer behavior. There are M kinds of behaviors, and when a girl is at state i, she will take behavior k with probability Aik. And again, for all the i, Ai1+Ai2+…+AiM=100<br><br>Now, given a sequence of a girl’s outer behavior and all the probabilities describe above (we don’t know how RoBa get them!), can you help him to find out the girl’s most probable inner state sequence?<br><center><img style='max-width:100%;' src=./data/images/2834-1.JPG></center><br>For example, as the figure above described, RoBa observes a girl for three minutes, and the behavior sequence is laugh -&gt; Silent -&gt; Silent. Then the poor boy wants to guess the girl’s real state. Let’s suppose he make a guess that the girl’s inner state sequence is happy -&gt; sad -&gt; happy. With the probabilities above, he can find its possibility is SHappy * AHappy,Laugh * PHappy,Sad * ASad,Silent * PSad,Happy * AHappy,Silent. So RoBa can calculate the possibility of all the inner state sequence, for example, sad-&gt;sad-&gt;happy, happy-&gt;happy-&gt;happy, and so on. Then he just simply picks the sequence with the highest possibility as the answer. Of course, this will cost too much time, so RoBa need a more clever algorithm to achieve the same result.<br><br>To be more formally, given a girl’s outer behavior sequence (B1, B2, … BT), it is natural that the possibility of a girl’s inner sequence (C1, C2, … CT) is <br><center><img style='max-width:100%;' src=./data/images/2834-2.JPG></center><br>Don’t be scared of the formula above, it just describe our intuition precisely. This problem is not such difficult as it seems, believe me .</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">There are several test cases in the input. <br><br>The first line of each test case contains N and M, (1 &lt;= N, M &lt;= 50), the second line contains N numbers S1, S2, …, SN, that is, the probability of girl’s initial states. Then an N*N matrix follow, whose entry in the i-th row and j-th column is Pij, that is, the probability of the girl’s transition from state i to state j. Then an N*M matrix follow, whose entry in the i-th row and k-th column is Aik, that is, the probability of the girl’s behavior is k when she is at state i. As the definition, the sum of each row of the two matrices is 100, and every entry in the matrices is an integer in the range [0,100]. And the last line begins with an integer T (1 &lt;= T &lt;= 50), indicating the observe time of RoBa, then T integers follow, indicating the girls outer behavior sequence. All the T integers are in the range [1..M].<br><br>You can assume the observation sequence is always possible in the input, that is, with probability greater than 0.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Output T integers in one line for each case, indicating this girl’s most probable inner state sequence. All the integers should be in the range [1..N], of course. You will get accepted if the possibility of your output is close enough to the standard output.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2 2
50 50
50 50
50 50
50 50
50 50
2 1 2

2 2
0 100
50 50
49 51
50 50
50 50
2 1 2</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1 1
2 2
<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
Hint: The first case indicating a rather “random” girl, all the initial states, transition, and behavior are of equal possibility, 
so the four possible inner state sequences 1-1, 1-2, 2-1, 2-2 are of equal possibility. In the second case, the girl is at state 2 definitely at the beginning. 
Then there is a little bigger chance to change to state 2 than state 1, so the sequence 2-2 is more possible than 2-1. 
</div><i style='font-size:1px'> </i></div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2009+Multi-University+Training+Contest+2+-+Host+by+TJU+&source=1&searchmode=source"> 2009 Multi-University Training Contest 2 - Host by TJU  </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>