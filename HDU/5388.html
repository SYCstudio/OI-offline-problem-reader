<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Geometer's Sketchpad</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5388. Geometer's Sketchpad</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：30000/15000 MS (Java/Others)</span> <span class="ui label">时间限制：262144/262144 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">  The Geometer's Sketchpad is a popular commercial interactive geometry software program for exploring Euclidean geometry, algebra, calculus, and other areas of mathematics.<br><br>  The Geometer's Sketchpad can solve most problems of plane geometry and plane analytic geometry, but it's powerless to solve solid geometry problems. Therefore, the famous mathematician BG, decided to develop a new software, named The Geometer's Sketchpad 3D.<br><br>  Because of the huge amount of work to do, BG decided to start from basic three-dimensional transformations. Similar to two-dimensional transformations, three-dimensional transformations include three basic types:<br>    1. Translation.<br><center><br><img style='max-width:100%;' src=./data/images/C596-1009-1.png><br></center><br>    2. Scaling.<br><center><br><img style='max-width:100%;' src=./data/images/C596-1009-2.png><br></center><br>    3. Rotation.<br><center><br><img style='max-width:100%;' src=./data/images/C596-1009-3.png><br></center><br><br>  Now there are $n$ points $P_1,P_2,P_3,\ldots,P_n$ in the three-dimensional space, and BG wanted to implement the following several transformation operations:<br>    1. For given integers $l,r,x,y,z$, translate points $P_l,P_{l+1},P_{l+2},\ldots,P_r$ by the vector $(x,y,z)$ at the same time;<br>    2. For given integers $l,r,x,y,z$ and the real number $k$, scale points $P_l,P_{l+1},P_{l+2},\ldots,P_r$ by the scale factor $k$ and the center point $(x,y,z)$ at the same time;<br>    3. For given integers $l,r,x,y,z,x',y',z'$ and the real number $\theta$, rotate points $P_l,P_{l+1},P_{l+2},\ldots,P_r$ counterclockwise around the axis determined by the point $(x,y,z)$ and the direction vector $(x',y',z')$ through an angle $\theta$ (in radian) at the same time.<br><br>  In addition, there are some measurement operations:<br>    1. For given integer $i$, calculate the current coordinates of the point $P_i$;<br>    2. For given integers $l,r$, calculate the current length of the polygonal chain $P_{l}P_{l+1}P_{l+2}\cdots P_{r}$. In other words, just calculate $|P_lP_{l+1}|+|P_{l+1}P_{l+2}|+\cdots+|P_{r-1}P_r|$, where $|PQ|$ means the Euclidean distance between points $P$ and $Q$.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">  There are multiple test cases.<br><br>  For each test case:<br><br>  The first line contains two positive integers $n,m~(1\le n,m \le 222222)$, representing the number of points and the number of operations.<br><br>  Next $n$ lines, each line contains three integers $x,y,z$, representing a point $(x,y,z)$ in the three-dimensional space.<br><br>  Next $m$ lines, each line describes an operation (without quotes):<br>    1. &quot;$\mathtt{Translation}~l~r~x~y~z$&quot;, translate points;<br>    2. &quot;$\mathtt{Scaling}~l~r~x~y~z~k$&quot;, scale points;<br>    3. &quot;$\mathtt{Rotation}~l~r~x~y~z~x'~y'~z'~\theta$&quot;, rotate points;<br>    4. &quot;$\mathtt{Coordinates}~i$&quot;, calculate the current coordinates of the point;<br>    5. &quot;$\mathtt{Length}~l~r$&quot;, calculate the current length of the polygonal chain.<br><br>  There is one blank line between successive tests. Values of $n=m=0$ indicate end of input.<br><br>  For the all of the above variables, $1 \le l,r,i \le n$, $-1000 \le x,y,z,x',y',z' \le 1000$, $0 &lt; k \le 2$, $-10 \le \theta \le 10$. $k$ and $\theta$ are real numbers, given with at most $6$ digits after the decimal point, and all other numbers are integers. You can sure that the absolute value of the answer does not exceed $10^{10}$ at any time.<br><br>  It is guaranteed $\sum n+\sum m \le 10^6$.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">  For each test case:<br><br>  First output one line containing &quot;$\texttt{Case #}i\texttt{:}$&quot;(without quotes), where $i$ is the test case number (starting from $1$).<br><br>  Then, for each &quot;$\mathtt{Coordinates}$&quot; operator, output one line containing three space-separated real numbers, representing the current coordinates of the point; for each &quot;$\mathtt{Length}$&quot; operator, output one line containing a real number, representing the current length of the polygonal chain.<br><br>  Your output will be considered correct if the absolute or relative error of every number does not exceed $10^{-4}$.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">5 10
0 0 0
2 0 0
2 1 0
0 1 0
0 0 0
Translation 1 5 1 1 0
Scaling 2 4 1 1 0 2
Coordinates 2
Coordinates 3
Length 2 3
Rotation 1 5 0 0 0 0 0 1 1.570796
Translation 1 2 0 0 100
Coordinates 2
Coordinates 3
Length 2 3

0 0</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case #1:
5.0000 1.0000 0.0000
5.0000 3.0000 0.0000
2.0000
-1.0000 5.0000 100.0000
-3.0000 5.0000 0.0000
100.0200</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2015+Multi-University+Training+Contest+8&source=1&searchmode=source"> 2015 Multi-University Training Contest 8 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>