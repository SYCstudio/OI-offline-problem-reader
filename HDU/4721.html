<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Food and Productivity</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU4721. Food and Productivity</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">In the Game Civilization X, the world is made up of square-shaped &quot;tiles&quot;, forming a rectangle on the world map. For a tile located at row X and column Y , we give it a coordinate, say (X, Y ).<br>As you can see, different tiles have different &quot;terrain-types&quot;, so they may have different amount of Resources. In this problem, we only consider two of them: Food and Productivity.<br>An important step in the Game is building cities. After you choose a tile to build a city, the Food amount in that tile will increase by A, and the Productivity amount will increase by B, no other tiles will be changed.<br>You decide to build your first city on the map, as an experienced player, you will choose the best tile on the map, here is how you make up your mind:<br>For each tile (X, Y ), you set up an &quot;Influence Range&quot; of that tile. Each tile (x<sub>i</sub>, y<sub>i</sub>) is said to be within the range if the following equation holds:<br><center>max(|X - x<sub>i</sub>| ,  |Y - y<sub>i</sub>|) &lt;= R</center><br>After checking all the tiles within that range, you will get two values: the sum of all those tiles' Food amount, and the sum of all those tiles' Productivity. Among those two values, the final score for tile (X, Y ) will be the smaller one.<br>When choosing tiles, you just choose the tile with the highest score to build your city.<br>You are given a map with size N * M, and you wonder, for different values of A and B, what is the highest score for your first city?</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first line has a number T (T &lt;= 10) , indicating the number of test cases.<br>For each test case, first line has four numbers N, M, R and Q (1 &lt;= N, M &lt;= 500, 0 &lt;= 2 * R + 1 &lt;= min(N,M), Q &lt;= 200000), which is the size of the map.<br>Then come N lines each with M numbers, they are the original Food (0 &lt; Food &lt;= 3) amount for each tile.<br>Then come N lines each with M numbers, they are the original <i>Productivity</i><br>(0 &lt; <i>Productivity</i> &lt;= 3) amount for each tile.<br>Then come Q lines each with two numbers A and B (0 &lt;= A, B &lt;= 10<sup>6</sup>). Each is a query for you to answer. Those queries will not affect each other.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For test case X, output \Case #X:&quot; first, in a single line.<br>Then output Q lines, each with an answer.<br>There should be a blank line <b>*BETWEEN*</b> each test case.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1
3 3 0 2
1 2 1
1 1 1
1 1 1
1 1 1
1 2 1
1 1 1
1 2
2 1</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case #1:
3
3</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2013+ACM%2FICPC+Asia+Regional+Online+%A1%AA%A1%AA+Warmup2&source=1&searchmode=source"> 2013 ACM/ICPC Asia Regional Online —— Warmup2 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>