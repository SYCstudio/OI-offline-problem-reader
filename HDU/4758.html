<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Walk Through Squares</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU4758. Walk Through Squares</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：4000/2000 MS (Java/Others)</span> <span class="ui label">时间限制：65535/65535 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><center><img style='max-width:100%;' src=./data/images/C479-1011-1.jpg></center> <br>&nbsp;&nbsp;On the beaming day of 60th anniversary of NJUST, as a military college which was Second Artillery Academy of Harbin Military Engineering Institute before, queue phalanx is a special landscape.<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;Here is a M*N rectangle, and this one can be divided into M*N squares which are of the same size. As shown in the figure below:<br>&nbsp;&nbsp;01--02--03--04<br>&nbsp;&nbsp;||  ||  ||  ||<br>&nbsp;&nbsp;05--06--07--08<br>&nbsp;&nbsp;||  ||  ||  ||<br>&nbsp;&nbsp;09--10--11--12<br>&nbsp;&nbsp;Consequently, we have (M+1)*(N+1) nodes, which are all connected to their adjacent nodes. And actual queue phalanx will go along the edges.<br>&nbsp;&nbsp;The ID of the first node,the one in top-left corner,is 1. And the ID increases line by line first ,and then by column in turn ,as shown in the figure above.<br>&nbsp;&nbsp;For every node,there are two viable paths:<br>&nbsp;&nbsp;(1)go downward, indicated by 'D';<br>&nbsp;&nbsp;(2)go right, indicated by 'R';<br>&nbsp;&nbsp;The current mission is that, each queue phalanx has to walk from the left-top node No.1 to the right-bottom node whose id is (M+1)*(N+1).<br>    In order to make a more aesthetic marching, each queue phalanx has to conduct two necessary actions. Let's define the action:<br>&nbsp;&nbsp;An action is started from a node to go for a specified travel mode.<br>&nbsp;&nbsp;So, two actions must show up in the way from 1 to (M+1)*(N+1).<br><br>&nbsp;&nbsp;For example, as to a 3*2 rectangle, figure below:<br>&nbsp;&nbsp;&nbsp;&nbsp;01--02--03--04<br>&nbsp;&nbsp;&nbsp;&nbsp;||  ||  ||  ||<br>&nbsp;&nbsp;&nbsp;&nbsp;05--06--07--08<br>&nbsp;&nbsp;&nbsp;&nbsp;||  ||  ||  ||<br>&nbsp;&nbsp;&nbsp;&nbsp;09--10--11--12<br>&nbsp;&nbsp;Assume that the two actions are (1)RRD  (2)DDR<br><br>&nbsp;&nbsp;As a result , there is only one way : RRDDR. Briefly, you can not find another sequence containing these two strings at the same time.<br>&nbsp;&nbsp;If given the N, M and two actions, can you calculate the total ways of walking from node No.1 to the right-bottom node ?</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">&nbsp;&nbsp;The first line contains a number T,(T is about 100, including 90 small test cases and 10 large ones) denoting the number of the test cases.<br>&nbsp;&nbsp;For each test cases,the first line contains two positive integers M and N(For large test cases,1&lt;=M,N&lt;=100, and for small ones 1&lt;=M,N&lt;=40). M denotes the row number and N denotes the column number.<br>&nbsp;&nbsp;The next two lines each contains a string which contains only 'R' and 'D'. The length of string will not exceed 100. We ensure there are no empty strings and the two strings are different.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">&nbsp;&nbsp;For each test cases,print the answer MOD 1000000007 in one line.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2
3 2
RRD
DDR
3 2
R
D</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1
10</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2013+ACM%2FICPC+Asia+Regional+Nanjing+Online&source=1&searchmode=source"> 2013 ACM/ICPC Asia Regional Nanjing Online </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>