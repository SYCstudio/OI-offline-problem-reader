<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Calculator</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5238. Calculator</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：10000/5000 MS (Java/Others)</span> <span class="ui label">时间限制：131072/131072 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Sakura has invented a new kind of calculator that can evaluate expressions. This calculator maintains a serial of operators and numbers inside. All these numbers and operators form an ordered table. For example<br><br>$*4 \quad  + 2 \quad \hat{} 3 \quad + 8 \quad * 6$<br><br>is a possible table. The calculator also supports the following two operations.<br><br>1. 1 $x$.<br><br>This corresponds to the evaluation operation. For instance, if $x=2$, together with the table being the one described above, the calculator will output<br><br>$ ((((2*4)+2)^3)+8)*6=6048.$<br><br>As for $x=3$, it will output<br><br>$((((3*4)+2)^3)+8)*6=16512.$<br><br>2. 2 $p$ $cx$.<br><br>This corresponds to the modification operation. The calculator will change the $p$-th term in the expression to $cx$. Here $c$ denotes an operator while $x$ denotes a number.<br><br>For example, if $p=3$ and $cx=*5$, the expression will become<br><br>$*4 \quad  + 2 \quad *5 \quad + 8 \quad * 6.$<br><br>Now you are asked to implement this calculator. However, for technical reasons, you should just output the result modulo 29393. It is guaranteed that, in all terms appeared in the input data, $c \in \{+, *, \hat{} \}$, $0 \le x &lt; 29393$.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first line contains an integer $T$($T \le 10$), denoting the number of test cases. It is guaranteed that $1 \le n, m \le 50000$.<br><br>For each test case, the first line contains two numbers $n, m$. $n$ denotes the number of terms in the expression, $m$ denotes the number of operations.<br><br>In the following $n$ lines, each line contains a term in style of $cx$, denotes each term in the initial table.<br><br>In the following $m$ lines, each line contains an operation. It must in style of ''$1 \quad x$'' or ''$2\quad p \quad cx$''.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each test case, output Case #t: in a single line to represent the $t$-th case.<br>Then in each test case, output the result modulo 29393 for each evaluation operation.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2
5 4
*4
+2
^3
+8
*6
1 2
1 3
2 3 *5
1 3
4 3
*4
^4
+4
*10
1 1
2 3 ^4
1 1</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case #1:
6048
16512
468
Case #2:
2600
4107
P</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=The+2015+ACM-ICPC+China+Shanghai+Metropolitan+Programming+Contest&source=1&searchmode=source"> The 2015 ACM-ICPC China Shanghai Metropolitan Programming Contest </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>