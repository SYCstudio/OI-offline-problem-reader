<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Cipher </title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU2694. Cipher </h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：3000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The Playfair cipher or Playfair square is a manual symmetric encryption technique and was the first literal digraph  <br>substitution cipher. The technique encrypts pairs of letters (digraphs), instead of single letters as in the simple  <br>substitution cipher and rather more complex Vigenère cipher systems then in use. The Playfair is thus significantly harder  <br>to break since the frequency analysis used for simple substitution ciphers does not work with it. Frequency analysis can still  <br>be undertaken, but on the 600 possible digraphs rather than the 26 possible monographs. The frequency analysis of digraphs  <br>is possible, but considerably more difficult and it generally requires a much larger ciphertext in order to be useful. <br><br>Despite its invention by Wheatstone, it became known as the Playfair cipher after Lord Playfair, who heavily promoted its  <br>use. The first recorded description of the Playfair cipher was in a document signed by Wheatstone on 26 March 1854.It was  <br>used for tactical purposes by British forces in the Second Boer War and in World War I and for the same purpose by the  <br>Australians and Germans during World War II. This was because Playfair is reasonably fast to use and requires no special  <br>equipment. A typical scenario for Playfair use would be to protect important but non-critical secrets during actual combat. <br> By the time the enemy cryptanalysts could break the message, the information was useless to them. <br><br>However Playfair is no longer used by military forces because of the advent of digital encryption devices. Playfair is now  <br>regarded as insecure for any purpose because modern hand-held computers could easily break the cipher within seconds. <br><br>The Playfair cipher uses a 5 by 5 table containing a keyword or phrase. Memorization of the keyword and some simple  <br>rules was all that was required to create the 5 by 5 table and use the cipher. <br>To generate the key table, one would first  <br>fill in the spaces in the table with the letters of the keyword (dropping any duplicate letters), then fill the remaining  <br>spaces with the rest of the letters of the alphabet in order (combine 'I' and 'J' to reduce the alphabet to fit). <br><br>To encrypt a message, one would change the lowercase to uppercase, break the message into digraphs (groups of 2 letters  <br>and throw away spaces) such that, for example, &quot;Hello World&quot; becomes &quot;HE LL OW OR LD&quot;, and map them out on the key table.  <br>The two letters of the digraph look like the corners of a rectangle in the key  <br>table. Note the relative position of the corners of this rectangle. Then apply the following rules, in order, to each pair  <br>of letters in the plaintext: <br>If both letters are the same (or only one letter is left), add an 'X' after the first letter. Encrypt the new pair and continue. <br><br>If the letters appear on the same row of your table, replace them with the letters to their immediate right respectively  <br>(wrapping around to the left side of the row if a letter in the original pair was on the right side of the row). <br><br>If the letters appear on the same column of your table, replace them with the letters immediately below respectively  <br>(wrapping around to the top side of the column if a letter in the original pair was on the bottom side of the column). <br><br>If the letters are not on the same row or column, replace them with the letters on the same row respectively but at the <br> other pair of corners of the rectangle defined by the original pair. <br>The order is important-the first encrypted letter of the pair is the one that lies on the same row as the first plaintext letter. <br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The input consists of multiple test cases. The first line of input contains an integer T, which is the number of test cases. <br>Each test case containing two lines: the key and the message. <br>The length of the key and the message will  <br>not exceed 500. <br>You may assume that the message does not contain substring such as &quot;XX&quot;, &quot;IJ&quot; , &quot;JI&quot;, and does not end with &quot;X&quot;. </div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each test case, print one line containing the encrypted message. <br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3
Charles 
Meet me at the Hammersmith Bridge tonight 
Death 
Laboulaye Lady 
to go to jail together 
to stand up for freedom together </code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">GDVBYTBCQYPRSCRKYKDCDIMPASHMEMDOUGKIRP 
MEIKQOTXCQTEZY 
OGNITUMPQDIEKHHWDPADOGOHGLHB 

<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>Hint1. 
Using "Death" as the key, the table becomes: 
D E A T H 
B C F G I / J 
K L M N O 
P Q R S U 
V W X Y Z 

NOTE that 'J' is in same place with 'I'! 

Encrypting the message "Laboulaye Lady": 
LA BO UL AY EL AD YX 

The pair LA forms a rectangle, replace it with ME. 
The pair BO forms a rectangle, replace it with IK. 
The pair UL forms a rectangle, replace it with QO. 
The pair AY forms a rectangle, replace it with TX. 
The pair EL in a column, replace it with CQ. 
The pair AD in a row, replace it with TE. 
The pair YX in a row, replace it with ZY. 

ME IK QO TX CQ TE ZY 
Thus the message becomes "MEIKQOTXCQTEZY". 
2. 
Assume one wants to encrypt the digraph OR. There are three general cases: 
1)                   2)                   3) 
* * * * *            * * O * *            Z * * O * 
* O Y R Z            * * B * *            * * * * * 
* * * * *            * * * * *            * * * * * 
* * * * *            * * R * *            R * * X * 
* * * * *            * * Y * *            * * * * * 
Hence, OR -> YZ      Hence, OR -> BY      Hence, OR -> ZX</div><i style='font-size:1px'> </i></div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=The+4th+Baidu+Cup+Central+China+Invitational+Programming+Contest&source=1&searchmode=source"> The 4th Baidu Cup Central China Invitational Programming Contest </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>