<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Matrix Puzzle</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU3334. Matrix Puzzle</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：8000/4000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">As you know, math is quite incredible.For example,if you want to know all x that not only satisfy the expression A^x = B ( mod C) where A,B and C are given and C is a prime number, but also smaller than C, you could use the following algorithm <br>(http://en.wikipedia.org/wiki/Baby-step_giant-step).<br>Now your task is quite simple. You are given A,B, here A and B are matrixes( n X n).You are expected to solve the following expression.<br><img style='max-width:100%;' src=./data/images/C235-1002-1.png> mod 1000000007</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">There are no more than 20 cases.<br>For each case,there are two integers n,L  in the first line indicating the size of the matrixes , the value of L. (Here 1&lt;= n &lt;= 50, 1&lt;= L &lt;= 10^11)<br>Then follows 2n lines.<br>For the first n lines, indicating the matrix A.<br>For the next n lines, indicating the matrix B.<br>All the numbers in the matrix are between 0 and 10^9</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Output a single line with “Case #idx: ”,here idx is the case number start from 1. Then output if there is only one valid solution (the solution must no larger than L and larger than 0).<br>If there is only one valid solution ,then just output “Yes”, otherwise output “No”.<br>We  assure that the ABS(|A|) (determinant’s abosolute value)is always larger than one after the mod operation in all the cases.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1 6
2
2

1 4
2
1

2 3
1 2
2 1
5 4
4 5</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case 1: Yes
Case 2: No
Case 3: Yes</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=HDOJ+Monthly+Contest+%A8C+2010.03.06&source=1&searchmode=source"> HDOJ Monthly Contest – 2010.03.06 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>