<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Mahjong</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5548. Mahjong</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/2000 MS (Java/Others)</span> <span class="ui label">时间限制：234567/234567 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The game of Mahjong originated in China and has become popular around the world. You do not need to have prior experience with Mahjong to solve this problem, and we will use different rules.<br><br>In our version of Mahjong, the player is given a set of $4K$0 tiles. Each tile has an integer rank written on it, and there are four identical copies of each rank from 1 to $K$. For example, for $K=5$, the set of tiles would be: 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5.<br><br>The player's goal is to select $M$ tiles from this set to form a winning hand. A winning hand consists of some number (possibly zero) of triples plus <b>exactly</b> one pair. A pair must consist of two tiles of the same rank. A triple can be either three tiles of the same rank (e.g., &quot;2 2 2&quot;), or three tiles with consecutive ranks (e.g., &quot;3 4 5&quot;). The ranks do not wrap around -- for example, &quot;4 5 1&quot; is not a valid triple.<br><br>Given $K$ and $M$, how many different winning hands are there? Two winning hands are considered the same if they use the same set of tiles, regardless of how those tiles are grouped to make triples and the pair. For instance, for $K=4$, $M=8$, the following two hands are considered the same:<br><br>&quot;1 2 3, 1 2 3, 4 4&quot;<br><br>&quot;1 1, 2 3 4, 2 3 4&quot;</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first line of the input gives the number of test cases, $T(1≤T≤100)$. $T$ lines follow. Each line contains two space-separated integers, $K(1≤K≤200)$ and $M(2≤M≤min(200,4K)$ and $M≡2(mod3))$.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each test case, output one line containing <b>Case #x: y</b>, where $x$ is the test case number (starting from 1) and $y$ is the number of winning hands, modulo $1000000007 (10^{9}+7)$.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">4
1 2
3 5
4 5
9 14</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case #1: 1
Case #2: 9
Case #3: 20
Case #4: 13259
<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
In Case #1, there are only four tiles -- 1, 1, 1, 1 -- and the winning hand must consist of just a pair (with no triples). There is only one possibility -- "1 1". 
(Note that all the "1"s are interchangeable and it doesn't matter which two you pick.)

In Case #2, there are twelve tiles -- 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3 -- and the winning hand must consist of one triple and one pair. The nine possible hands are:

1 1 1, 2 2
1 1 1, 3 3
2 2 2, 1 1
2 2 2, 3 3
3 3 3, 1 1
3 3 3, 2 2
1 2 3, 1 1
1 2 3, 2 2
1 2 3, 3 3

Note that "3 3, 1 1 1" would not be considered a different hand from "1 1 1, 3 3" -- only the set of tiles matters, not how they are arranged.
</div><i style='font-size:1px'> </i></div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=The+2015+China+Collegiate+Programming+Contest&source=1&searchmode=source"> The 2015 China Collegiate Programming Contest </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>