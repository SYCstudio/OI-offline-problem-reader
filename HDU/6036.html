<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Division Game</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU6036. Division Game</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：10000/5000 MS (Java/Others)</span> <span class="ui label">时间限制：131072/131072 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">There are $k$ piles of stones in a circle, numbered from $0$ to $k - 1$, where the number of the stones in each pile is $n$ initially. You can do some round operations, where the initial round is numbered as the $1$-st round.<br><br>The operation of the $i$-th round is to modify the pile of stones numbered $(i - 1) \bmod k$. In each round, you should remove from this pile some stones (at least one stone), satisfying that the number of stones in this pile before this operation is a multiple of the number of stones in this pile after operation, which means that you ought to remain at least one stone in this pile.<br><br>The game is ended if there exists at least one pile containing only one stone. Given two positive integers $n$ and $k$, your task is to calculate for each pile the number of the possible operation plans that it is the last operated pile before the game is ended.<br><br>The integer $n$ may be very large, so the prime-factor decomposition of $n$ will be given, in other words, if $n = \prod_{i = 1}^{m}{p_i^{e_i}}$, then the integers $m$ and $(p_i, e_i)$ $(1 \leq i \leq m)$ will be given, but the integer $n$ will not.<br><br>The answer may be very large, so you only need to give the value of the answer modulo $985661441$.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The input contains multiple test cases.<br><br>For each test case:<br><br>The first line contains two positive integers $m$ and $k$, satisfying that $1 \leq m, k \leq 10$.<br><br>In next $m$ lines, the $i$-th line contains two positive integers $p_i$ and $e_i$, satisfying that $2 \leq p_i \leq 10^9,$ $e_i \geq 1,$ $\sum_{i = 1}^{m}{e_i} \leq 10^5$.<br><br>It is guaranteed that $p_1, p_2, \cdots, p_m$ are distinct.<br><br>About $200$ test cases in total, where no more than $5$ cases satisfy $\sum_{i = 1}^{m}{e_i} \geq 10^4$.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each test case, output &quot;<b>Case #$x$: $y_0$ $y_1$ $\cdots$ $y_{k - 1}$</b>&quot; in one line (without quotes), where $x$ indicates the case number starting from $1$ and $y_i$ $(0 \leq i &lt; k)$ denotes the number of the possible operation plans modulo $985661441$ for the pile numbered $i$ of corresponding case.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1 1
2 2
2 1
3 1
5 1
1 2
2 3
2 2
2 4
5 4</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case #1: 2
Case #2: 3
Case #3: 6 4
Case #4: 1499980 1281085</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2017+Multi-University+Training+Contest+-+Team+1&source=1&searchmode=source"> 2017 Multi-University Training Contest - Team 1 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>