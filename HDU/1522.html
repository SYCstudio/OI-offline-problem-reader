<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Marriage is Stable</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU1522. Marriage is Stable</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：65536/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Albert, Brad, Chuck are happy bachelors who are in love with Laura, Marcy, Nancy. They all have three choices. But in fact, they do have some preference in mind. Say Albert, he likes Laura best, but that doesn't necesarily mean Laura likes him. Laura likes Chuck more than Albert. So if Albert can't marry Laura, he thinks Nancy a sensible choice. For Albert, he orders the girls Laura &gt; Nancy &gt; Marcy.<br><br>For the boys:<br><br>Albert: Laura &gt; Nancy &gt; Marcy<br>Brad: Marcy &gt; Nancy &gt; Laura<br>Chuck: Laura &gt; Marcy &gt; Nancy<br><br>For the girls:<br><br>Laura: Chuck &gt; Albert &gt; Brad<br>Marcy: Albert &gt; Chuck &gt; Brad<br>Nancy: Brad &gt; Albert &gt; Chuck<br><br>But if they were matched randomly, such as<br><br>Albert &lt;-&gt; Laura <br>Brad &lt;-&gt; Marcy<br>Chuck &lt;-&gt; Nancy<br><br>they would soon discover it's not a nice solution. For Laura, she likes Chuck instead of Albert. And what's more, Chuck likes Laura better than Nancy. So Laura and Chuck are likely to come together, leaving poor Albert and Nancy.<br><br>Now it's your turn to find a stable marriage. A stable marriage means for any boy G and girl M, with their choice m[G] and m[M], it will not happen that rank(G, M) &lt; rank(G, m[G]）and rank(M, G) &lt; rank(M, m[M]).<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Each case starts with an integer n (1 &lt;= n &lt;= 500), the number of matches to make.<br><br>The following n lines contain n + 1 names each, the first being name of the boy, and rest being the rank of the girls.<br><br>The following n lines are the same information for the girls.<br><br>Process to the end of file.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">If there is a stable marriage, print n lines with two names on each line. You can choose any one if there are multiple solution. Print &quot;Impossible&quot; otherwise.<br><br>Print a blank line after each test.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3
Albert Laura Nancy Marcy
Brad Marcy Nancy Laura
Chuck Laura Marcy Nancy
Laura Chuck Albert Brad
Marcy Albert Chuck Brad
Nancy Brad Albert Chuck</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Albert Nancy
Brad Marcy
Chuck Laura</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=ZOJ&source=1&searchmode=source"> ZOJ </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>