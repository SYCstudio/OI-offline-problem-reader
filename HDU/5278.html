<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>YJC plays automaton</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5278. YJC plays automaton</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：12000/6000 MS (Java/Others)</span> <span class="ui label">时间限制：524288/262144 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">YJC is an old driver of mini train, so he was the gold medal winner of &quot;The fatter, the better&quot; Contest held by socks mill sesame seed bun column. An automaton caught his eye during his trip to CTSC (Consume The Special Course).<br><br>The automaton has $n+1$ states, numbered from $0$ to $n$, while $0$ represents $NULL$. So he started his study out of curiosity:<br><br>He picked out a set of start states $S$ and found some rather interesting features:<br><br>There **exists** a string $str$, satisfying that after running $str$ on each element in set $S$ you will get some final states including $NULL$ and at least one state other than $NULL$. In other words, the number of the final states $NULL$ you will get should be in the range $[1,|S|-1]$. (At least one element will be $NULL$ and at least one element won't be $NULL$)<br><br>The sets meeting these requirements are called YJC sets.<br><br>Be aware that YJC set is not allowed to include $NULL$.<br><br>He wants to know how many YJC sets there are.<br><br><br>If automaton is a fresh word to you, you can try to understand it this way:<br><br>An automaton has $n+1$ states, numbered from $0$ to $n$, while $0$ represents $NULL$.The size of the alphabet of the automaton is $m$.<br><br>$\delta(i,j)(0\leq i \leq n,1\leq j\leq m)$, satisfying $0\leq \delta(i,j)\leq n$ and $\delta(0,j)=0$ is called a transition function.<br><br>Here is a program explaining how a string $str$ runs on a state $t$:<br><br>$for$  $i=0..str.length-1$<br>    $t\leftarrow \delta(t,str[i])$ <br><br>If you still cannot understand how automaton works, you can turn to<br><br>https://en.wikipedia.org/wiki/Automata_theory<br><br>for further information!</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Multiple tests.<br><br>For each test:<br><br>The first line contains two integers $n,m(1\leq n\leq 888,1\leq m\leq 8)$, indicating the size of the automaton and the size of the alphabet.<br><br>The next n lines:<br><br>Each line lie $m$ elements, indicating transition function $\delta (i,j)$, the state $i$ transitions to $\delta (i,j)$ after reading the character $j$. Also, 0 represents $NULL$.<br>($1\leq i \leq n$ and $1\leq j \leq m$)<br><br>$NULL$ can only transitions to $NULL$.<br><br>There should be one and only one space between two integers, also, each line ends with an integer not a space. The file should end with one and only one line break.<br><br>In the final test, input file contains no more than 11000 lines. 31 groups of tests in total.<br><br>Because the final test consists of only one input file, there should be quite a lot small-range cases.<br><br>If your program can pass the largest single case within 0.5s (CPU 3.0 GHz), it shall pass the final test. <br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each test:<br><br>One line an integer $ans$, indicating the number of YJC sets.<br>(modulo $998244353(7\times 17\times 2^{23}+1 $ a prime$))$</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3 2
3 0
3 0
0 3</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3

<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>

The possible YJC sets are $\{1,3\},\{2,3\},\{1,2,3\}$.

State $1$ is equivalent to $2$, so obviously ${1,2}$ is not a YJC set.


</div><i style='font-size:1px'> </i></div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=BestCoder+Round+%2346&source=1&searchmode=source"> BestCoder Round #46 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>