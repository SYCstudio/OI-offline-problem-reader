<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Clumsy Algorithm</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU4783. Clumsy Algorithm</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">　　Sorted Lists are thought beautiful while permutations are considered elegant. So what about sequence (1, 2, ... , n) ? It is the oracle from god. Now Coach Pang finds a permutation (p<sub>1</sub>, p<sub>2</sub>, ... , p<sub>n</sub>) over {1, 2, ... , n} which has been shuffled by some evil guys. To show Coach Pang’s best regards to the oracle, Coach Pang decides to rearrange the sequence such that it is the same as (1, 2, 3, ... , n). The time cost of swapping p<sub>i</sub> and p<sub>j</sub> is 2|i- j| - 1. Of course, the minimum time cost will be paid since Coach Pang is lazy and busy. Denote the minimum time cost of the task as f(p). But Coach Pang is not good at maths. He finally works out a clumsy algorithm to get f(p) as following:<br><center><img style='max-width:100%;' src=./data/images/C487-1003-1.jpg></center> <br>　　Coach Pang’s algorithm is clearly wrong. For example, n = 3 and (3, 2, 1) is the permutation. In this case, f(p) = 3 but g(p) = 0 + 0 + 2 = 2. The question is that how many permutations p of {1, 2, ... , n}  such that f(p) = g(p). To make the problem more challenge, we also restrict the prefix of p to (a<sub>1</sub>, a<sub>2</sub>, ... ,  a<sub>k</sub>). To sum up, you need to answer the question that how many permutations p of {1, 2, ... , n}  with the fixed prefix p<sub>1</sub> = a<sub>1</sub>, p<sub>2</sub> = a<sub>2</sub>, ... , p<sub>k</sub> = a<sub>k</sub> such that f(p) = g(p). Since the answer may be very large, for convenience, you are only asked to output the remainder divided by (10<sup>9</sup> + 7).</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">　　The first line contains a positive integer T(1 &lt;= T &lt;= 100), which indicates the number of test cases. T lines follow. Each line contains n, k, a<sub>1</sub>, a<sub>2</sub>, a<sub>3</sub>, ... , a<sub>k</sub>. (1 &lt;= n &lt;= 100, 0 &lt;= k &lt;= n, 1 &lt;= a<sub>i</sub> &lt;= n and all a<sub>i</sub> are distinct.)<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">　　For each test case, output one line “Case #x: y”, where x is the case number (starting from 1) and y is the answer to each test case.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2
3 0
5 2 1 4</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case #1: 5
Case #2: 3

<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
Among all permutations over {1, 2, 3}, {3, 2, 1} is the only counter-example.
</div><i style='font-size:1px'> </i></div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2013+Asia+Chengdu+Regional+Contest+&source=1&searchmode=source"> 2013 Asia Chengdu Regional Contest  </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>