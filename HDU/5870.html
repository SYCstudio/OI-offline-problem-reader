<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Alice's Adventure in Wonderland</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5870. Alice's Adventure in Wonderland</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：262144/262144 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Alice studies in one university in Dalian. You may not know that she is an idiot in finding the right way to somewhere. One day, she got lost on her way to a teaching building. Believe it or not, she got lost on the campus where she had lived for three years. By the way, she is a little lazy, so she always chooses the shortest possible way to go.<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;Last night, Alice had a dream that she was in Wonderland. She was shown a map of this place. As far as she can remember, there are $N$ towns numbered from 1 to $N$, connected by $M$ bi-directed roads. Now, she was in the #$1$ town, heading for the #$N$ town. Alice had an ability in her dream that she could build another (only one) road  not existing on the map before, the length was arbitrarily selected by Alice. Note that multiple edges and self-loops are not allowed after the edge added. <br>&nbsp;&nbsp;<br>&nbsp;&nbsp;Now, she gets an idea that she adds one road so that the number of the shortest paths from the #$1$ town to the #$N$ town increased would be no less than $X$ ($X$ is given). To get the job done, Alice needs to choose two distinct towns which are not yet connected directly by an existing road and then links them up with a new road. As to the weight, it is a positive integer determined at her will. By the way, Alice is quite clever much of the time, but sometimes gets confused just for no reason and unfortunately, in her dream, she was confused by this problem. Alice wanted to know how many different choices she had when choosing those two towns. Note that choosing town A and B is considered the same as choosing town B and A. Can you help her?</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">There are several test cases. For each case, the first line  contains two  integers $N$ and $M$ as described above. The second line is an integer $X$. Then $M$ lines follow, each contains three integers $u, v, w$ meaning a bi-directed road between $u$ and $v$ of length $w$. Tests end with the case $N=M=0$, which shouldn't be processed. <br><br>You can assume that<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;$2\le N\le20 000$ <br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; $0\le M \le 100 000$ <br>&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp; $1\le u,v \le N$ <br>&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp; $1\le w\le 10 000$<br>&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp; $1\le X\le 1000 000 000$</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each case output the answer on a single line.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3 2
1
1 2 1
2 3 1
0 0</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2016+ACM%2FICPC+Asia+Regional+Dalian+Online&source=1&searchmode=source"> 2016 ACM/ICPC Asia Regional Dalian Online </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>