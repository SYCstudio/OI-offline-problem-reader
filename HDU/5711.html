<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Ingress</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5711. Ingress</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：102400/65535 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Brickgao, who profited from your accurate calculating last year, made a great deal of money by moving bricks. Now he became ``gay shy fool'' again and recently he bought an iphone and was deeply addicted into a cellphone game called Ingress. Now he is faced with a problem so he turns to you for help again. We make some slight modifications based on the original rules, so please draw attention to the details below.<br><br>There are $N$ portals (indexed from 1 to $N$) around Brickgao's home, and he can get some substances called XM by hacking the portals. It's known that for each portal $i$, he can get $A_i$ XM during the first hack, and after each hack, the amount of XM he will get during the next hack will decrease by $B_i$. If the amount of XM he can get is less than or equal to zero, Brickgao can't get XM from that portal anymore. For the $i$-th portal, if $A_i = 10, B_i = 2$ and he hacks 3 times, he will get 10, 8, 6 XM during each hack.<br><br>There are $M$ bidirectional roads between some pairs of portals and between Brickgao's home and some portals. Now he is eager to start his Ingress journey from home and finally return home, but due to the extremely hot weather, Brickgao will feel sick when you hack more than $K$ times or the distance he covers is more than $L$. So how much XM he can get at most during this journey?<br><br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first line contains a single integer $T(T\leq 20)$, indicating the number of test cases.<br><br>The first line of each case are four integers $N(1\leq N \leq 16), M(0 \leq M \leq \frac{N(N+1)}{2}), K(1 \leq K \leq 50)$ and $L(2 \leq L \leq 2000)$.<br>The second line of each case contains $N$ non-negative integers where the $i$-th denotes $A_i(A_i \leq 500)$.<br>The third line of each case contains $N$ non-negative integers where the $i$-th denotes $B_i(B_i \leq 50)$.<br>Each of next $M$ line contains 3 non-negative integers $u, v ( 0\leq u,v\leq n)$ and $c (0\leq c\leq 1000)$ , denotes that there is a road with the length of $c$ between the $u$-th and the $v$-th portal. If $u$ or $v$ equals to 0, it means Brickgao's home.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each test case, output the case number first, then the amount of maximum XM Brickgao can get.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2
1 1 3 2
5
3
0 1 1
3 6 3 5
10 7 5
2 3 1
0 1 3
0 2 1
0 3 1
1 2 2
2 3 3
1 3 4</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case 1: 7
Case 2: 16</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=%26quot%3B%B0%CD%BF%A8%CB%B9%B1%AD%26quot%3B+%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC+-+%C5%AE%C9%FA%D7%A8%B3%A1&source=1&searchmode=source"> &quot;巴卡斯杯&quot; 中国大学生程序设计竞赛 - 女生专场 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>