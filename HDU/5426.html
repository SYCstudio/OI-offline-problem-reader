<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Rikka with Game</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5426. Rikka with Game</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：12000/6000 MS (Java/Others)</span> <span class="ui label">时间限制：524288/524288 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">As we know, Rikka is poor at math. Yuta is worrying about this situation, so he gives Rikka some math tasks to practice. But today Rikka doesn't want to do math tasks, so they begin to play some games:<br><br>Long long ago, There is a continent which has $n$ citis and $n-1$ roads on it. Each city is connected to others directly or indirectly. <br><br>Now you want to build your own kingdom and make city 1 be the capital. Then you will cut off all the roads which connects a city which belong to your country and a city outside your country. Your country must satisfy the following rules:<br><br>1.City 1 must belong to your country.<br><br>2.Each pair of cities in your country can get to each other by the roads which haven't been cut off.<br><br>After cutting off the roads, actually, the continent has been cut to many unicom blocks. And then each unicom block develops into an independent state. To preserve the peace, you need to choose at most $k$ other counties (can't be your own country) and establish diplomatic relations with them.<br><br>Each city have a prosperous value $w_i$ and the prosperous value of each country is equal to the sum of the prosperous value of the citis in it. And the stable value of your country is eaual the prosperous value of your own country plus $a \times$ the sum of the prosperous value of the countrie which have diplomatic relations with you.<br><br>Now, you need to maximal the stable value.<br><br>It is too difficult for Rikka. Can you help her?</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">There are no more than 1000 testcases and there are no more than 3 testcase meet $n,k \geq 100$.<br><br>For each testcase, the first line contains three integers $n,a,k(1 \leq n \leq 10^5, -10^3 \leq a \leq 10^3, 0 \leq k \leq 500)$.<br><br>The second line contains $n$ integers $w_i(-10^9 \leq w_i \leq 10^9)$<br><br>Then $n-1$ lines follow. Each line contains two numbers $u,v(1 \leq u,v \leq n)$ , which means there is an edge between $u$ and $v$. </div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each testcase, print a single number -- the answer.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3 2 1
10 100 1000
1 2
1 3</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2110

Hint
Your country is {1,2} and you can establish diplomatic relations with {3}. Finally the stable value is 2110.</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=BestCoder+Round+%2353+%28div.1%29+%28%24%29&source=1&searchmode=source"> BestCoder Round #53 (div.1) ($) </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>