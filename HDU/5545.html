<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>The Battle of Guandu</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5545. The Battle of Guandu</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：6000/3000 MS (Java/Others)</span> <span class="ui label">时间限制：65535/65535 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">In the year of 200, two generals whose names are Cao Cao and Shao Yuan are fighting in Guandu. The battle of Guandu was a great battle and the two armies were fighting at $M$ different battlefields whose numbers were 1 to $M$. There were also $N$ villages nearby numbered from 1 to $N$. Cao Cao could train some warriors from those villages to strengthen his military. For village $i$, Cao Cao could only call for some number of warriors join the battlefield $x_{i}$. However, Shao Yuan's power was extremely strong at that time. So in order to protect themselves, village $i$ would also send equal number of warriors to battlefield $y_{i}$ and join the Yuan Shao's Army. If Cao Cao had called for one warrior from village $i$, he would have to pay $c_{i}$ units of money for the village. There was no need for Cao Cao to pay for the warriors who would join Shao Yuan's army. At the beginning, there were no warriors of both sides in every battlefield.<br><br>As one of greatest strategist at that time, Cao Cao was considering how to beat Shao Yuan. As we can image, the battlefields would have different level of importance $w_{i}$. Some of the battlefields with $w_{i}=2$ were very important, so Cao Cao had to guarantee that in these battlefields, the number of his warriors was greater than Shao Yuan's. And some of the battlefields with $w_{i}=1$ were not as important as before, so Cao Cao had to make sure that the number of his warriors was greater or equal to Shao Yuan's. The other battlefields with $w_{i}=0$ had no importance, so there were no restriction about the number of warriors in those battlefields. Now, given such conditions, could you help Cao Cao find the least number of money he had to pay to win the battlefield?</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first line of the input gives the number of test cases, $T(1≤T≤30)$. $T$ test cases follow.<br><br>Each test case begins with two integers $N$ and $M(1≤N,M≤10^{5})$ in one line.<br><br>The second line contains $N$ integers separated by blanks. The $i_{th}$ integer $x_{i}(1≤x_{i}≤M)$ means Cao Cao could call for warriors from village $i$ to battlefield $x_{i}$.<br><br>The third line also contains $N$ integers separated by blanks. The $i_{th}$ integer $y_{i}(1≤y_{i}≤M)$ means if Cao Cao called some number of warriors from village $i$, there would be the same number of warriors join Shao Yuan's army and fight in battlefield $y_{i}$.<br><br>The next line contains $N$ integers separated by blanks. The $i_{th}$ integer $c_{i}(0≤c_{i}≤10^{5})$ means the number of money Cao Cao had to pay for each warrior from this village.<br><br>The last line contains $M$ integers separated by blanks. The $i_{th}$ number $w_{i}(w_{i}∈{0,1,2})$ means the importance level of $i_{th}$ battlefield.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each test case, output one line containing <b>Case #x: y</b>, where $x$ is the test case number (starting from 1) and $y$ is the least amount of money that Cao Cao had to pay for all the warriors to win the battle. If he couldn't win, $y=-1$.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2
2 3
2 3
1 1
1 1
0 1 2
1 1
1
1
1
2</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case #1: 1
Case #2: -1</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=The+2015+China+Collegiate+Programming+Contest&source=1&searchmode=source"> The 2015 China Collegiate Programming Contest </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>