<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Just A Mistake</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5121. Just A Mistake</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：5000/5000 MS (Java/Others)</span> <span class="ui label">时间限制：512000/512000 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">   As we all know, Matt is an outstanding contestant in ACM-ICPC. Graph problems are his favorite.<br><br>   Once, he came up with a simple algorithm for finding the maximal independent set in trees by mistake.<br><br>   A tree is a connected undirected graph without cycles, and an independent set is subset of the vertex set which contains no adjacent vertex pairs.<br><br>   Suppose that the tree contains N vertices, conveniently numbered by 1,2, . . . , N. First, Matt picks a permutation p<sub>1</sub>, p<sub>2</sub>, . . . , p<sub>N</sub> of {1, 2, 3, . . . , N } randomly and uniformly.<br><br>   After picking the permutation, Matt does the following procedure.<br><br>   1.Set S =  <img style='max-width:100%;' src=./data/images/C556-1010-1.jpg>.<br>   2.Consider the vertex p<sub>1</sub>, p<sub>2</sub>, . . . , p<sub>N</sub> accordingly. For vertex p<sub>i</sub>, if and only if there is no vertex in S which is adjacent to p<sub>i</sub>, add vertex p<sub>i</sub> into S.<br>   3.Output the set S.<br><br>   Clearly the above algorithm does not always output the maximal independent set. Matt would like to know the expected size of set S instead.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">   The first line contains only one integer T , which indicates the number of test cases.<br><br>   For each test case, the first line contains an integer N (1 ≤ N ≤ 200), indicating the number of vertices in the graph.<br><br>   Each of the following N - 1 lines contains two integers u, v (1 ≤ u, v ≤ N ) indicating an edge between u and v. You may assume that all the vertices are connected.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">   For each test case, output a single line “Case #x: y”, where x is the case number (starting from 1) and y is the answer. To avoid rounding error, the answer you should output is:<br><br><center>(the expected size of independent set) × N! mod (10<sup>9</sup> + 7)</center></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2
4
1 2
1 3
1 4
3
1 2
2 3</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case #1: 60
Case #2: 10

<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>In the &#64257;rst sample, there are 4 vertices, so there are 4! permutations Matt may get.
Suppose the permutation Matt gets is 1 2 3 4. He will add vertex 1 into the independent set.
Suppose the permutation Matt gets is 2 1 3 4. He will add vertex 2, vertex 3 and vertex 4 into the independent set.
It is obvious that if the &#64257;rst element in the permutation is not vertex 1, he will get an independent set whose size is 3. Otherwise, he well get an independent set whose size is 1. Since there are 18
permutations whose &#64257;rst element is not vertex 1, the answer in the &#64257;rst sample is (3 × 18 + 1 × 6) mod (10^9 + 7) = 60.
</div><i style='font-size:1px'> </i></div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2014ACM%2FICPC%D1%C7%D6%DE%C7%F8%B1%B1%BE%A9%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%B1%B1%CA%A6%BA%CD%C9%CF%BD%BB%A3%A9&source=1&searchmode=source"> 2014ACM/ICPC亚洲区北京站-重现赛（感谢北师和上交） </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>