<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Circuit Board</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU3860. Circuit Board</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：10000/5000 MS (Java/Others)</span> <span class="ui label">时间限制：131072/65536 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Recently Silence has got a new circuit board with which he will do a new experiment. <br><br>Now we can assume that the circuit board is made of R lines and each line has C holes. And we can only put a wire between the adjacent holes. We say a hole is adjacent to another one if and only if it is at the up, down, left or right side of the other one. <br><center><img style='max-width:100%;' src=./data/images/C352-1002-1.jpg></center><br>This is a circuit board and we can add wires like this.<br><br>Now P holes on the left side of the board are power sources and each one can afford a specific amount of electric current. And O holes on the right side of the board are output interfaces and each one needs a specific amount of electric current.<br><br>In order to complete the experiment we should put some wires on the board so that we can meet every output interface on the board (we don’t have to use up all the power). But the circuit board is a little old so between some adjacent holes we can only put a wire whose capacity is not greater than a specific value. And what’s more, some of the holes are fault holes which means the fault hole can’t be connect to any adjacent holes, we assume no power sources or output interfaces are fault holes.<br><br>Now we have several different kinds of wires and each kind of wire has a specific capacity. And we can use as many wires as we want of each kind. But as we know the wire which has a higher capacity is much more expensive than the one which has a lower capacity. So we should make the highest capacity of the wires we use as low as possible. <br><br>Now it is your turn to write a program to get the best solution whose highest capacity of all the wires is as low as possible. You can just output the highest capacity of the best solution.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">There are several test cases in this problem. The first line of the input is an integer T(1 &lt;= T &lt;= 10), which means there are T test cases in the input.<br>&nbsp;&nbsp;<br>The first line of each test case is two integers R and C (2 &lt;= R, C &lt;= 200), which means the circuit board has R lines and each line has C holes. And the coordinate of the upper left corner is always (1, 1).<br><br>Then there is an integer P(1 &lt;= P &lt;= R) means P holes of the left side is power sources. And each of the next P lines has two integers Ai, Si (1 &lt;= Ai &lt;= R, 0 &lt; Si &lt;= 1000), which indicates the i-th power source is located at (Ai, 1) and can afford Si amount of electric current. Then there is an integer O (1 &lt;= O &lt;= R) means O holes of the right side is Output interfaces. And each of the next O lines has two integer Bi, Ti, (1 &lt;= Bi &lt;= R, 0 &lt; Ti &lt;= 1000), which indicates the i-th output source is located at (Bi, C) and needs Ti amount of electric current.<br><br>Then there is an integer Q (0 &lt;= Q &lt;= R*(C-1) + C*(R-1)), and the next Q lines each one has 5 integers x1, y1, x2, y2, m (0 &lt; x1,x2 &lt;= R, 0 &lt; y1, y2 &lt;= C, 0 &lt; m &lt;= 1000). That indicates between the holes at (x1, y1) and (x2, y2) we can only put a wire whose capacity is not greater than m. we assume that (x1, y1) and (x2, y2) are adjacent holes.<br><br>And then there is an integer K (0 &lt;= K &lt;= R * C – P - O). And each of the next K lines has two integers xi, yi, means there are k fault holes on the board and the i-th hole’s coordinate is (xi, yi).<br><br>Then there is an integer W (1 &lt;= W &lt;= 10000), means there are W kinds of wire we can choose. And the followed line has W integers u1, u2, …, uw. ui means the i-th kind of wire’s capacity is ui (0 &lt; ui &lt;= 100000).<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each test case, output one integer which is the minimum of the largest capacity we choose to complete the experiment. If we can’t complete it, output -1.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1
2 3
1
1 4
1
2 4
1
1 1 1 2 1
0
4
1 2 3 4</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3

<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div><center><img src='./data/images/C352-1002-2.jpg'></center> 
This is one of the solution of the sample input, so the answer is 3.</div><i style='font-size:1px'> </i></div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2011+Multi-University+Training+Contest+3+-+Host+by+BIT&source=1&searchmode=source"> 2011 Multi-University Training Contest 3 - Host by BIT </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>