<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Mad Veterinarian</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU4490. Mad Veterinarian</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><i>Mad Veterinarian</i> puzzles have a mad veterinarian, who has developed several machines  that  can  transform an animal into one or more animals and back again. The puzzle is  then  to determine if it  is possible  to change one collection of animals into another by applying  the machines in some order (forward or reverse). For example: <br><br>Machine A turns one ant into one beaver.<br>Machine B turns one beaver into one ant, one beaver and one cougar.<br>Machine C turns one cougar into one ant and one beaver.<br><br>Can we convert a beaver and a cougar into 3 ants?<br><img style='max-width:100%;' src=./data/images/C426-1007-1.jpg> <br><br>Can we convert one ant into 2 ants? NO<br><br>These puzzles have  the properties  that:  <br><br>1.  In forward mode, each machine converts one animal of a given species into a finite, non-empty collection of animals from  the species in the puzzle.<br>2.  Each machine can operate in reverse.<br>3.  There is one machine for each species in the puzzle and that machine (in forward mode) takes as input  one animal of  that  species.<br><br>Write a program  to find the shortest solution (if any)  to Mad Veterinarian puzzles.  For this problem we will restrict   to Mad Veterinarian puzzles with exactly  three machines, A, B, C.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first  line of input  contains a single integer P, (1&lt;= P &lt;= 1000 ), which is the number of data sets  that follow.  Each data set consists of several lines of input. Each data set  should be processed identically and independently.<br><br>The first line of each data set  consists of  two decimal integers separated by a single space.  The first integer is the data set  number.  The second integer is the number, N, of puzzle  questions.  The next three input lines contain the descriptions of machines A, B and C in that  order.  Each machine description line consists of  three decimal integers separated by spaces giving the number of animals of  type a, b and c output  for one input  animal.  The following N lines give  the puzzle questions for the Mad Veterinarian puzzle. Each contains seven decimal digits separated by single spaces:   the puzzle number,  the three starting animal counts for animals a, b and c followed by  the  three desired ending animal counts for animals a, b and c.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each input  data set   there are multiple lines of output. The first  line of output  for each data set contains  the data set  number, a space and the number of puzzle questions (N). For each puzzle question,  there is one line of output  which consists of  the puzzle question number followed by a space, followed by “NO SOLUTION”, (without  the quotes) if  there is no solution OR  the puzzle question number followed by  the shortest  number of machine steps used, a space and a sequence of letters [A B C a b c] with capital letters indicating applying the machine in the forward direction and lower case letters indicating applying  the machine in the reverse direction.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2
1 2
0 1 0
1 1 1
1 1 0
1 0 1 1 3 0 0
2 1 0 0 2 0 0
2 2
0 3 4
0 0 5
0 0 3
1 2 0 0 0 0 5
2 2 0 0 0 0 4</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1 2
1 3 Caa
2 NO SOLUTION
2 2
1 NO SOLUTION
2 25 AcBcccBccBcccAccBccBcccBc</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=Greater+New+York+2012&source=1&searchmode=source"> Greater New York 2012 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>