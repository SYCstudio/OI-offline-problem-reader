<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>ShaDan’  Problem</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU2251. ShaDan’  Problem</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：10000/5000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Long long ago , there is a person named ShaDan. He likes walking around the streets very much. He walks around the street until the sky is black every day. When he go back home , his mother always very angry with him. “what are you doing , it’ s  so late now” his mother always asked him loudly. ShaDan always answer “I’m watching the scenery around the street”.<br>One day, when ShaDan was walking around the street, he thought how can I visit all the streets and cost minimum time. So that, he can go back home earlier and his mother will not blame him. The streets ShaDan visited is very strange. They are all one-way streets. All the cars on a street is drived along in one direction. But ShaDan can walk around the street in two directions. For example , if the street is from city i to city j , cars can only be drived on the street from the city I to city j.  But ShaDan can walk around the street from the city i to city j and also can walk around  the street form the city j to city i .  In addition , ShaDan  have a Super-capacity.   Every  move  , he can  choose  a city i  ,  and  it  doesn’t  cost  time. When he is in a city I,he have two ways to visit the streets. <br>The first one :he is in the city  i , and  he can walk around all the streets that from the city i ( for example  i= 2  , he can walk 2-&gt;5, 2-&gt;3 , 2 - &gt;6 ,if there exists a street ),  it will costs he Wi  to  visit  all the streets from city i.<br>The second one : he is in the city i, and he can walk around all the streets  to city I  ( for example  i= 2  , he can walk 5-&gt;2, 4-&gt;2 , 3 - &gt;2 ,if there exists a street ), it will costs he Pi  to  visit  all the streets to city i.<br>Although ShaDan have a Super-capiacity , but his IQ is very low. <br>He is unable to deal with the problem . So he asked his best friends RPRUSH to help him to calculate the minimum time to visit all the streets.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Input contains multiple test cases. Each test case contains an integer N (1 &lt;= N &lt; = 300 , the number of city)  and  M (1 &lt;= m &lt;= 20000, the number of streets  )in a line first line , the second line contain n integers( from W1 to Wn ). The third line contain n integers (from P1 to Pn). Then followed M line, each line contain two integers a and b , means there is a street from city a to city b.<br>If there are two or more streets from city a to b , it is also legal. The input ends with a line that has two non-positive numbers.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each input case ,output a line containing a single number, which is the minimum time it need to visit all the streets.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3 3
1 2  4
4 1  3
1  2
2  3
3  1
0  0</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">7</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"></div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>