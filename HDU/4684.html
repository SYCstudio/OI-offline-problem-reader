<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>The Budget of Traveler</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU4684. The Budget of Traveler</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：20000/10000 MS (Java/Others)</span> <span class="ui label">时间限制：131072/131072 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">There is a country consisting of n cities. A traveler living in the city with number 1 loves travelling very much. He has made <br>n-1 travel plans, each plan has a unique destination(except city 1). After a travel, he will go back home. On the way back home,  <br>he will buy gifts for all his friends living in the cities(including the starting city and ending city) he will pass. For some<br>strange reasons, each city sells only one kind gift. Besides, packing the gifts need some extra cost.<br>Maybe you are still confused of the description, the following is the details<br>1. Note that the cities form a connected, undirected and a cyclic graph(in another word the cities form a tree).<br>2. When he goes back home after a travel, he will always choose the shortest route.<br>3. The n-1 plans are independent, that means, he will always prepare gifts for his friends ont the route no matter whether he has visited them before.<br>4. The gifts must be packed, and you must pack them in the city where you buy them.<br>5. The packing cost is no matter with the number of gifts. That is, packing two gifts cost the same money with packing one.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first line of the input contains an integer T( T&lt;= 10 ), indicating the number of test cases.<br>For each test case, the first line contains only one integers n, indicating the number of cities.<br>The next n lines, each line contains three integers f<sub>i</sub>, p<sub>i</sub>, r<sub>i</sub>, where f<sub>i</sub> is the number of his friend living in city i, p<sub>i</sub> is the price of each gift in city i, r<sub>i</sub> is the packing cost in the city i.<br>The next of n-1 lines, each line contains two integers u<sub>i</sub> and v<sub>i</sub>, indicating that the traveler can go to v<sub>i</sub> from u<sub>i</sub> or go to u<sub>i</sub> from v<sub>i</sub>.<br>You can assume 1&lt;=n&lt;=4*10<sup>5</sup>, 1&lt;=f<sub>i</sub>&lt;=10<sup>4</sup>, 1&lt;=p<sub>i</sub>,r<sub>i</sub>&lt;=10<sup>5</sup>, 1&lt;=u<sub>i</sub>,v<sub>i</sub>&lt;=n<br><br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For every test case,output one line,&quot;Case #k: ans&quot;,where k is the case number,counting from 1, ans is the minimum total cost.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1
3
1 10000 10000
1 1 20
1 100 1
1 2
1 3</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case #1: 223</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2013+Multi-University+Training+Contest+8&source=1&searchmode=source"> 2013 Multi-University Training Contest 8 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>