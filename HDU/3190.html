<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Marriage Match</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU3190. Marriage Match</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：6000/2000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">You may know the funny problem “The Stable Marriage Problem”. Now let’s find a new match algorithm. <br>Firstly the women and men stand in a line separately and each woman will choose the man she likes.<br>Then it’s your task to make a match for these people. You should choose m women and m men from the initial queues. Let them stand in a line separately by initial order.  If the woman stands in the ith place do not like the man stands in the ith place, the match is unacceptable. To increase the possibility of the match, the women can accept the men their friends like. Please find out the maximal m.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">There are several test cases.<br>Each test case starts with two integer p and q in a line means the number of women and the number of men.(0 &lt; p , q &lt;= 100000)<br>Then a line with p numbers follows means the queue of women. (The id ranges from 1 to p)<br>Then a line with q numbers follows means the queue of men. (The id ranges from 1 to q)<br>Then a line with p numbers which means the man the ith woman likes.<br>Then a line with an integer t, means the number of friendships between women.(0 &lt; t &lt; 100000)<br>Then t lines follow. Each line contains two numbers a and b means a and b are friends.(a!=b, 1 &lt;= a, b &lt;= p)<br>You may support the friendship can transmit. If a and b are friends and c and b are friends, then a and c are friends. Notice every woman will have no more than five friends.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each case, output the maximal m in one line.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">4 4
1 3 2 4
1 4 2 3
2 3 1 2
2
1 2
3 4</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=HDU+2009-11+Programming+Contest&source=1&searchmode=source"> HDU 2009-11 Programming Contest </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>