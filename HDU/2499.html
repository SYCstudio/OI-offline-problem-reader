<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Rotate to root</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU2499. Rotate to root</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Rotate-to-root is a heuristic for balancing binary search trees. In this problem, the contents of the tree will be ignored, and you will be asked about the effect the heuristic has on the structure of the tree.<br><br>A binary tree is either empty or consists of a node with a left child and a right child, where each of the children are also binary trees. No node has more than one parent, and there are no cycles. In any non-empty tree, there is exactly one node without a parent, which is called the root of the tree.<br><br>The rotate-to-root heuristic takes effect when a node in the tree, say X, is accessed. While X is not the root of the tree, the following procedure is executed:<br><ul><li>If X is the left child of its parent, a right tree rotation is performed. Let P be the parent of X, let A be X's left child, let B be X's right child, and let C be the right child of P. Then, P is replaced in the tree by X, so P's parent (if any) becomes X's parent; X's right child becomes P's left child (which replaces X); and P replaces X's right child. Diagram:</li><br><center><img style='max-width:100%;' src=./data/images/C240-1005-2.jpg></center><br><li>If X is the right child of its parent, a left tree rotation is performed. Let P be the parent of X, let A be the left child of P, let be B be X's left child, and let C be X's right child. Then, P is replaced in the tree by X, so P's parent (if any) becomes X's parent; X's left child becomes P's right child (which replaces X); and P replaces X's left child. Diagram:<br><br><center><img style='max-width:100%;' src=./data/images/C240-1005-1.jpg></center></li></ul><br>Tree rotations preserve the order of the nodes in the tree, which is why they are useful, but that is not important for this problem. <br><br>The height of a binary tree is the longest length of a path from its root to the bottom of the tree. More formally, the height of the empty tree is 0, and the height of a non-empty tree that has a root node X with children A and B is 1 + max{height(A), height(B)}.<br><br>Given a binary tree, you must determine, for each node X, what the height of the tree would be after X is rotated to root.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Input consists of a number of test cases. The first line of each test case contains the integer <i>N</i>, the number of nodes in the binary tree, where 1 &lt;= <i>N</i> &lt;= 10<sup>5</sup>.<br><br>The following <i>N</i> lines of input each contain two integers. The <i>i</i><sup>th</sup> pair of these integers is <i>l<sub>i</sub></i> and <i>r<sub>i</sub></i>, the left and right children of node <i>i</i>. If <i>l<sub>i</sub></i> = 0, then the left child of node <i>i</i> is the empty tree, and if <i>r<sub>i</sub></i> = 0, then the right child of node <i>i</i> is the empty tree. Otherwise, 1 &lt;= <i>l</i>, <i>r</i> &lt;= <i>N</i>.<br><br>It is guaranteed that the input will describe a binary tree.<br><br>The last test case is followed by a line containing the integer 0. This final line is not a test case and should not be processed.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Output consists of <i>N</i> lines for each test case, where the <i>i</i><sup>th</sup> line contains an integer giving the height of the tree after node <i>i</i> is rotated to root.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">4
2 3
4 0
0 0
0 0
0</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3
3
4
3</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=University+of+Waterloo+Local+Contest+2009.09&source=1&searchmode=source"> University of Waterloo Local Contest 2009.09 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>