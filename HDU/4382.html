<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Harry Potter and Cyber Sequence Generator</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU4382. Harry Potter and Cyber Sequence Generator</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">    After Voldemort and the Death Eater were wiped out by Harry Potter and his friends, Harry becomes the glory of the Wizarding World, magician treat him as model, hero, king… and much more than that.<br>&nbsp;&nbsp;  Recently Harry Potter and his friends have been researching a kind of toy from the Muggle World, with the name Cyber Sequence Generator, wondering if after manipulated in some certain way, it can be useful and powerful for magicians.<br>　　This kind of generator has two magic containers C1 and C2, if we put a magic element in C1, after its magic is all over, the result magic element can be taken from C2. Because we Muggles(I’m sorry if you are not a muggle, you can ask me for magic student version of this problem statement even you are competing and can’t use the Internet) do not know magic languages, let’s rearrange the words to describe how the generator works.<br>　　The generator’s work can be split into simple works. Each work is like:<br><pre><br>     SET|ADD    C1|C2,    C1|C2|IntegerNumber<br>     MUL        C1|C2,    IntegerNumber<br></pre><br>By “SET a,b “, we have the value of the element in container a changed to b<br>By “ADD a,b “, we have the value of the element in container a added by b<br>By “MUL a,b “, we have the value of the element in container a multiplied by b<br>   After each of the operations, the value in b will not change.<br>　　Here C1, C2 denotes actually the value of magic element. <br>C2’s initial value is 0.<br>　　All works are done in the order in input.<br>　　<br>　　Harry always has a magic element V at first, and can use the generator arbitary times, and wonders if so, what is the value of the result element.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">　　One line T, the number of test cases.<br>　　For each test case, first line contains one integer V. Then a few lines describe the Cyber Sequence Generator, ended by “END”.<br>　　Then an integer Q, the number of Queries. <br>　　Q number following describe how many times Harry use the generator, for each query N , we have the initial value is V, and C2’s initial value is 0.<br>　　The instruction is like &quot;SET_a,_b&quot;.(underscore '_' is just used to demonstrate blank char)<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">　　For each test case, first output a line &quot;Case num:&quot;, while num is the case number, based on 1. There is one space between 'Case' and 'num' and no more blanks in the same line.<br>　　<br>For each query, output a line of the value of the result magic element, modulo prime p = 10<sup>9</sup>+7(i.e 1 000 000 007).<br>　　<br>Constraints<br>   1&lt;=T&lt;=10<br>   1&lt;=N&lt;=10<sup>100</sup><br>   1&lt;=Q&lt;=100<br>　　One generator has no more than 100 instructions.<br>　　All integer constants in SET/ADD/MUL instruction will fit 32-bit integer type.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2
1
ADD C1, 1
SET C2, C1
END
5
1
2
3
4
5
1
ADD C1, C1
SET C2, 1
ADD C2, C1
SET C1, C2
END
5
1
2
3
4
5</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case 1:
2
3
4
5
6
Case 2:
3
7
15
31
63</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2012+Multi-University+Training+Contest+9&source=1&searchmode=source"> 2012 Multi-University Training Contest 9 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>