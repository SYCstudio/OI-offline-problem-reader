<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Hurry Up</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU3904. Hurry Up</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：5000/2000 MS (Java/Others)</span> <span class="ui label">时间限制：125536/65536 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Now I'm in my school and I want to go back home as on time. However my bicycle has been stolen, which means I have to take buses. Let's consider the bus-net as a diagram. Vertices of the diagram (numbered 1, 2,..., N), correspond to stations, edges &lt;pi, pj&gt;(pi != pj), denote that there is a direct connections from the station pi to the station pj (1&lt;= pi, pj &lt;= N). Transportation lines are numbered 1, 2,..., K. The L-th transportation line is defined as a series of stations p<sub>L,1</sub>, p<sub>L,2</sub>,..., p<sub>L,sL</sub>, on which vehicles of the L-th line stop, and durations r<sub>L,1</sub>, r<sub>L,2</sub>,...,r<sub>L,sL-1</sub> of traveling between stations--- r<sub>L,1</sub> is the time necessary to get from the station p<sub>L,1</sub> to the station p<sub>L,2</sub>, or vice versa (i.e. from the station p<sub>L,2</sub> to the station p<sub>L,1</sub>); r<sub>L,2</sub> is the time necessary to get from the station p<sub>L,2</sub> to p<sub>L,3</sub>, etc. All the stations of a line are different (i.e. i != j, implies p<sub>L,i</sub> != p<sub>L,j</sub>). In the L-th transportation line, buses run with certain frequency c<sub>L</sub>, and c<sub>L</sub> is a number from the set {6, 10, 12, 15, 20, 30, and 60}. The buses in the L-th transportation line, start from the station p<sub>L,1</sub>  at each hour of the day and night, g:0, (0&lt;= g &lt;=23), and then according to the frequency of the line i.e. at g:cL, g:2cL,... etc. (g:c<sub>L</sub> means c<sub>L</sub> minutes after hour g). Buses of the L-th line run in two directions: from the station p<sub>L,1</sub> to p<sub>L,sL</sub>, and from the station p<sub>L,sL</sub> to p<sub>L,1</sub>. The hours of departure of the buses of the L-th transportation line from the station p<sub>L,sL</sub> are the same as from the station p<sub>L,1</sub>. In such a bus-net, we want to have a trip from the start station X which is near my school to the finish station Y which is near my home. During the trip one can change transportation lines, if he/she wants to. Say, the time of a change is equal to 0, however, while changing the line we have to take under consideration the time of waiting for the bus that we want to get into. Because of my poor memory, I can only change the line in no more than T (1&lt;= T &lt;= 20) times. And your task is to find a way from the start station X, to the finish station Y in W (0&lt;= W &lt;= 1440) minutes and change the lines as few as possible, if there are many ways to go back home and change the same least times of bus, choose the quickest one.<br><br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">In the first line there are written 8 integers, separated by single spaces:<br>N (1&lt;= N &lt;=200, number of stations), K (1&lt;= K &lt;=300, number of lines), X (1&lt;= X &lt;=N, the start station), Y (1&lt;= Y &lt;=N, X != Y, the finish station), GX (0&lt;= GX &lt;=23, the hour of the beginning of the trip), MX (0 &lt;= MX &lt;= 59, the minute of the beginning of the trip), W (0&lt;= W &lt;= 1440, the minute you must go back home within), T (1&lt;= T &lt;= 20, the times of changing line).<br><br>The stations are numbered from 1 to N, the transportation lines from 1 to K. In the following 3K lines the transportation lines are described - the description of each of them takes three consecutive lines.<br><br>In the first line describing the L-th transportation line, there are written two integers, separated by a single space: s<sub>L</sub>, the number of stations (2&lt;= s<sub>L</sub> &lt;=N), and c<sub>L</sub> - the frequency with which the vehicles run (c<sub>L</sub> belongs to: {6, 10, 12, 15, 20, 30, 60}).<br><br>In the second line describing the L-th transportation line, there are s<sub>L</sub> different integers, separated by single spaces: p<sub>L,1</sub>,p<sub>L,2</sub>,...,p<sub>L,sL</sub> --- the numbers of consecutive stations on the transportation line NO. L (1&lt;= p<sub>L,i</sub> &lt;=N, for 1&lt;= i &lt;=s<sub>L</sub>).In the third line describing the L-th transportation line, there are written s<sub>L</sub>-1 integers separated by single spaces: r<sub>L,1</sub>, r<sub>L,2</sub>,..., r<sub>L,sL-1</sub> --- the times (in minutes) necessary to go between the consecutive stations of this transportation line (1&lt;= r<sub>L,i</sub> &lt;=240, for 1&lt;= i &lt;=s<sub>L</sub>-1).<br>The total number of stations on all transportation lines is not greater than 4000 (i.e. s<sub>1</sub>+s<sub>2</sub>+...+s<sub>K</sub> &lt;= 4000).<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Your program should write in the only line with three integers, separated by a single space: the least times you change the lines, the hour of the earliest possible arrival to the finish station GY (0&lt;= GY &lt;=23) and the minute of the earliest possible arrival to the finish station MY (0&lt;= MY &lt;=59). If I can't go back home within W minutes anyway, puts &quot;NO&quot; in a single line.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">6 2 5 6 23 30 1440 20
4 15
1 3 4 6
9 12 10
4 20
5 3 4 2
11 17 11</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1 0 16</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2011+Multi-University+Training+Contest+7+-+Host+by+ECNU&source=1&searchmode=source"> 2011 Multi-University Training Contest 7 - Host by ECNU </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>