<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Guess the Money</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5049. Guess the Money</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：65536/65536 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">   Dshawn is a tuhao. He has a lot of money. One day, he gave A dollars to kuangbin and cxlove. kuangbin got B dollars and cxlove got C dollars. Obviously, A = B + C.<br><br>   wuyiqi is very curious, he want to know the A,B and C. But they didn’t tell him. Just tell him some information about the three numbers.<br><br>   Dshawn said that the number A has N<sub>1</sub> digits in its decimal representation (without extra leading zero). Assume the digits of its decimal expansion from the left to the right are a<sub>0</sub>, a<sub>1</sub>, ..., a<sub>N1 - 1</sub>. Dshawn didn’t tell wuyiqi all the digits but tell him M<sub>1</sub> digits.<br><br>   kuangbin said that the number B has N<sub>2</sub> digits in its decimal representation (without extra leading zero). Assume the digits of its decimal expansion from the left to the right are b<sub>0</sub>, b<sub>1</sub>, ..., b<sub>N2 - 1</sub>. kuangbin didn’t tell wuyiqi all the digits but tell him M<sub>2</sub> digits.<br><br>   cxlove said that the number C has N<sub>3</sub> digits in its decimal representation (without extra leading zero). Assume the digits of its decimal expansion from the left to the right are c<sub>0</sub>, c<sub>1</sub>, ..., c<sub>N3 - 1</sub>. cxlove didn’t tell wuyiqi all the digits but tell him M<sub>3</sub> digits.<br><br>   You should find the number of possible {A, B, C}. It is possible that someone tells lies, so if the information given is inconsistent with any possible {A, B, C}, you should also detect this.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">   The first line of the input is T (1 ≤ T ≤ 50), which stands for the number of test cases you need to solve.<br><br>   The first line of each case contains two integers N<sub>1</sub>,M<sub>1</sub> (1 ≤ N<sub>1</sub> ≤ 10<sup>7</sup>, 0 ≤ M<sub>1</sub> ≤ min(N<sub>1</sub>, 10<sup>4</sup>)).<br><br>   For the next M<sub>1</sub> lines, each line contains two integers id and x (0 ≤ id &lt; N<sub>1</sub>, 0 ≤ x ≤ 9) means a<sub>id</sub> = x.<br><br>   The next line contains two integers N<sub>2</sub>,M<sub>2</sub> (1 ≤ N<sub>2</sub> ≤ 10<sup>7</sup>, 0 ≤ M<sub>2</sub> ≤ min(N<sub>2</sub>, 10<sup>4</sup>)).<br><br>   For the next M<sub>2</sub> lines, each line contains two integers id and x (0 ≤ id &lt; N<sub>2</sub>, 0 ≤ x ≤ 9) means b<sub>id</sub> = x.<br><br>   The next line contains two integers N<sub>3</sub>,M<sub>3</sub> (1 ≤ N<sub>3</sub> ≤ 10<sup>7</sup>, 0 ≤ M<sub>3</sub> ≤ min(N<sub>3</sub>, 10<sup>4</sup>)).<br><br>   For the next M<sub>3</sub> lines, each line contains two integers id and x (0 ≤ id &lt; N<sub>3</sub>, 0 ≤ x ≤ 9) means c<sub>id</sub> = x.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">   For each test case, print a line “Case #t: ”(without quotes, t means the index of the test case) at the beginning.<br><br>   If it is impossible, please output “IMPOSSIBLE” else output the answer modulo 20140927.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3
2 0
1 1
0 9
1 0
1 1
0 5
1 0
1 0
2 0
3 0
2 0</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case #1: 9
Case #2: 6
Case #3: IMPOSSIBLE</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2014+ACM%2FICPC+Asia+Regional+Shanghai+Online&source=1&searchmode=source"> 2014 ACM/ICPC Asia Regional Shanghai Online </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>