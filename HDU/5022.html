<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Ene's problem</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5022. Ene's problem</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：6000/3000 MS (Java/Others)</span> <span class="ui label">时间限制：65536/65536 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">   Ene was a girl lives in computer systems. When she was studying the periodic sequence b<sub>n</sub> = B<sup>n</sup> mod P (B is an integer and P is a prime number, n &gt;= 0), she chose a contiguous subsequence b<sub>s</sub>, b<sub>s + 1</sub>, …, b<sub>t</sub>, and marked them as special numbers. Then she began to investigate another sequence a<sub>n</sub> = M × A<sup>n</sup> mod P, (M and A are integers) and incidentally such a problem came to her mind: what is the minimum non-negative integer k such that a<sub>k</sub> is a special number(k starts from 0) ?<br> <br>   As a result of Ene's ability to control a computer, she soon answered the question of herself. But as she had never taken any computer science courses, she could only enumerate all possible solutions to get the answer. Your task is to solve her questions faster, so your algorithm should possess a lot higher performance than hers.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">   There are no more than 100 test cases in the input. In each case, you are given six integers M, A, B, s, t, P, satisfying 2 ≤ A, B, M &lt; P ≤ 10<sup>9</sup>，0 ≤ s ≤ t &lt; P - 1, and P is a prime number. The input ends by 0 0 0 0 0 0.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">   For each test case, output your answer k in one line. If there's no solution, output &quot;impossible&quot; (no quotes).</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2 3 5 1 6 11
2 3 8 1 6 11
0 0 0 0 0 0</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">impossible
1

<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>   In the first test case, b1 = 5, b2 = 3, b3 = 4, b4 = 9, b5 = 1, b6 = 5, and a0 = 2, a1 = 6, a2 = 7, a3 = 10, a4 = 8, a5 = 2, it makes a cycle.
   On the other hand, in the second test case, b1 = 8, b2 = 9, b3 = 6, b4 = 4, b5 = 10, b6 = 3, and a0 = 2, a1 = 6 = b3. So that answer is 1.
</div><i style='font-size:1px'> </i></div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2014+ACM%2FICPC+Asia+Regional+Guangzhou+Online&source=1&searchmode=source"> 2014 ACM/ICPC Asia Regional Guangzhou Online </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>