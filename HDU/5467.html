<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Clarke and hunger games</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5467. Clarke and hunger games</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：6000/3000 MS (Java/Others)</span> <span class="ui label">时间限制：65536/65536 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Clarke is a patient with multiple personality disorder. One day, Clarke split into a lot of guys, live in $n$ communities.  <br>Clarkes are so boring, so they play a game called hunger games.  <br>They live in a city in the sky, so they connect each other by the bridge between communities.  <br>Clarkes are very economical, so there is only one path between any two communities if they can reach each other.  <br>The rules of the hunger games are like this: each community elects two guys, then send them to participate this death game.  <br>Clarkes want to know how many combinations to elect guys to participate the game, any two combinations are same if and only if the guys selected are same.  <br>Clarkes are so boring, so they have $q$ operations:  <br>1. $u$ $v$: build a bridge between $u$ and $v$. If $u$ and $v$ already have a path connected or $u=v$, ignore.  <br>2. $u$ $v$: remove the bridge between $u$ and $v$. If there is no bridge between $u$ and $v$ or $u=v$, ignore.  <br>3. $h$: back to the state that end of operation $h$. If $h=0$, the state should roll back to the initial state, which has no bridge connecting any two communities.  <br>4. $u$ $v$: ask how many combinations to elect guys from the communities on the path $u$ to $v$(including $u$ and $v$) to participate the game. Since the answer is very large, you only need to output the answer modulo $10^9+7$.  <br>5. $u$ $s$: change the number of the community $u$ to $s$.  <br><br>At beginning, there is no edge between any two communities.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first line contains a integer $T(1 \le T \le 5)$, the number of test cases.  <br>For each test case:  <br>The first line contains two integers $u, q(1 \le n, q \le 3*10^5)$.  <br>The second line contains $n$ integers, the $ith$ integer $a_i(0 \le a_i \le 10^4)$denotes the number of the $ith$ communities.  <br>Then $q$ lines follow, the first number is $opt$:  <br>If $opt=1$, then two integers $u_i, v_i$ follow, represent operation $1$  <br>If $opt=2$, then two integers $u_i, v_i$ follow, represent operation $2$  <br>If $opt=3$, then one integer $h_i$ follow, represent operation $3$  <br>If $opt=4$, then two integers $u_i, v_i$ follow, represent operation $4$  <br>If $opt=5$, then two integers $u_i, s_i$ follow, represent operation $5$  <br>$1 \le u_i, v_i \le n, 0 \le h_i &lt; i, 0 \le s_i \le 10^4$  </div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each testcase, for each $opt=4$, print the answer.  </div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1
3 5
1 2 3
1 1 2
2 1 2
3 1
5 1 3
4 1 2</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3

Hint:
At the beginning, community $1$ has 1 guy, $2$ has 2 guys, $3$ has 3 guys.
Operation 1: build a bridge between $1$ and $2$
Operation 2: remove the bridge between $1$ and $2$.
Operation 3: back to state $1$, which has bridge between $1$ and $2$.
Operation 4: change the number of community $1$ from $1$ to $5$.
Operation 5: enquire the combinations of community $1$ and $2$. Obviously, the answer is 3.</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=BestCoder+Round+%2356+%28div.1%29+%28%24%29&source=1&searchmode=source"> BestCoder Round #56 (div.1) ($) </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>