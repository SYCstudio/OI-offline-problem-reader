<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Boolean String Expression</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU3643. Boolean String Expression</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Mike needs a bike and he decides to buy a second-hand one to save money. Luckily, he has found a second-hand goods BBS. However, there are so many messages there and it will be extremely boring for him to look through all those messages and figure out which one contains the information he needs. So he decides to write a program to do this.<br><br>The problem is: how to determine whether a message is about selling a bike. Mike decides to use a keyword-find-based algorithm. First choose some keywords and then the program checks whether a message contains these keywords or not. For example, he wants to find messages that contain 'bike'，and at the same time have 'sell' or don't have 'buy' (&quot;bike on sell&quot;, &quot;bike&quot;, &quot;sell bike and buy …&quot;are all what he needs, but &quot;buy bike&quot; is not). Of course he wants his program can be used to handle things more than buying a bike.<br><br>As the string matching nature of the keyword-find-based algorithm, regular expression should be quite suitable here. But after a second thought, he throws it away: he even can't figure out what the corresponding regular expression is for a simple query &quot;don't have the word 'buy'&quot;.<br><br>After further thinking of this problem, Mike comes up with a great idea: combining string matching with Boolean algebra! He names it as &quot;Boolean String Expression&quot;.<br><br>Formally, a Boolean String Expression is composed of normal strings, ‘&amp;’(and), ‘|’(or) and ‘!’(not). A Boolean String Expression s matches a message M when:<br>1. s is a normal string, and it's a substring of M<br>2. s = a &amp; b, a and b are both Boolean String Expressions that match M<br>3. s = a | b, a and b are both Boolean String Expressions, and at least one of them matches M<br>4. s = ! a, a is Boolean String Expression which doesn't match M<br><br>Precedence of the three operators is: ‘!’ &gt; ‘&amp;’ &gt; ‘|’. And parenthesis can be used to change precedence of operators. Mike's query can be easily expressed as:<br>bike &amp; (sell | !buy)<br>Mike is very satisfied with this solution, but he comes to another problem: nearly all expressions can be changed into another form with the same meaning. For example, &quot;bike &amp; (sell | !buy)&quot; has a equivalent form of:<br>(bike &amp; sell) | (bike &amp; !buy)<br>It may seem to be obvious to you. However, it confuses Mike a lot and he needs your help to write a problem to check whether two Boolean String Expressions are equivalent. (Equivalent here means: all messages that match one expression will match the other, all messages that don't match one expression will not match the other too)<br><br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first line contains an integer indicating the number of test cases (&lt;=30).<br>Each test case contains three lines: The first line is an alphabet that contains only lower case letters. Suppose all messages we care about are only composed of those letters. The second line and 3rd line are two Boolean String Expressions. The expression contains only characters from the alphabet and '&amp;', '|', '!' , and its length is no more than 20.<br><br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each test case, output a line of 'Yes' if the two expressions are equivalent, 'No' otherwise.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">4
abcdefghijklmnopqrstuvwxyz
bike&(sell|!buy)
bike&sell|bike&!buy
abc
a&(b|c)
a&b|c
ab
ab&!a
ab&!b
ab
a|b
a|!a</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Yes
No
Yes
No

<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
Case 3: Both expressions match nothing, so they are equivalent.
Case 4: Both expressions match all non-empty messages. However, the second expression can match an empty message, while the first one can’t.

</div><i style='font-size:1px'> </i></div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2010+Asia+Regional+Hangzhou+Site+%A1%AA%A1%AA+Online+Contest&source=1&searchmode=source"> 2010 Asia Regional Hangzhou Site —— Online Contest </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>