<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Inverse</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU3218. Inverse</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">YY and LMY both love mathematics. One day LMY wrote down an integer 3 and two polynomials <img style='max-width:100%;' src=./data/images/3218-1.jpg>and<img style='max-width:100%;' src=./data/images/3218-2.jpg>on a piece of paper. <br>YY noticed that 3 is a prime. Besides, he found that f(x) has a degree strictly less than g(x). And all coefficients of the two polynomials are between 0 and 2, <br>inclusively. His most important discovery is, that there is a polynomial <img style='max-width:100%;' src=./data/images/3218-3.jpg> , such that<br><br><center><img style='max-width:100%;' src=./data/images/3218-4.jpg></center><br>Then YY added a restriction: all coefficients of h(x) must be between 0 and 2 inclusively, and its degree must be less than g(x). Finally, he found that the polynomial<br> h(x) with such properties is unique.<br><br>The property that a polynomial f(x) with all its coefficients between 0 and p-1 inclusively, where p is a prime number, is called that f(x) is in the polynomial ring<br> defined on field Zp. Note that<img style='max-width:100%;' src=./data/images/3218-5.jpg>. Such a polynomial ring is called Zp[x].<br><br><center><img style='max-width:100%;' src=./data/images/3218-6.jpg></center><br>Then h(x) is called a multiplicative inverse of f(x), defined on the quotient ring Zp[x]/(g(x)). YY wonders if such an inverse always exists and is unique.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Input contains multiple test cases.<br><br>For each test case, the first line contains a prime number p.<br><br>The following line consists of two positive integers n and m (n&lt;m), indicating the degrees of f(x) and g(x).<br><br>The following line contains n+1 integers, a0, a1… an, indicating the coefficients of f(x), i.e.,<img style='max-width:100%;' src=./data/images/3218-7.jpg>. It is guaranteed that f(x) is<br> in Zp[x] and an≠0.<br><br>The following line contains m+1 integers, b0, b1… bm, indicating the coefficients of g(x), i.e.,<img style='max-width:100%;' src=./data/images/3218-8.jpg>. It is guaranteed that g(x)<br> is in Zp[x] and bm≠0.<br><br>Input ends with a line where p=0.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each test case, if the multiplicative inverse of f(x) (defined on Zp[x]/(g(x))) does not exist, output only one line containing “NO SOLUTION”(quotes excluded);<br> if the multiplicative inverse is not unique, output only one line containing “NO UNIQUE SOLUTION”(quotes excluded). Otherwise, you should output two lines <br> indicating the unique multiplicative inverse h(x), using the same format as in the input.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2
1 2
0 1
0 0 1
3
1 3
1 1
1 1 0 1
0</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">NO SOLUTION
2
2 2 1
<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
The variable x in a polynomial can be evaluated as anything satisfying the commutative and the associative laws and having the modular p operation, not only
 members of Zp. So polynomials x2+x and 0 in Z2[x] are different.
</div><i style='font-size:1px'> </i></div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2009+Shanghai+Network+Contest+Host+by+DHU&source=1&searchmode=source"> 2009 Shanghai Network Contest Host by DHU </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>