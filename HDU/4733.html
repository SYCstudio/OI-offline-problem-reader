<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>G(x)</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU4733. G(x)</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：2000/500 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For a binary number x with n digits (A<sub>n</sub>A<sub>n-1</sub>A<sub>n-2</sub> ... A<sub>2</sub>A<sub>1</sub>), we encode it as <img style='max-width:100%;' src=./data/images/C477-1006-1.jpg><br>Where &quot;<img style='max-width:100%;' src=./data/images/C477-1006-2.jpg>&quot; is bitwise XOR operation and &quot;<img style='max-width:100%;' src=./data/images/C477-1001-2.jpg>&quot; indicates the largest integer which is not greater than x.<br>Due to some reasons, Mzry1992 encode his password P into G(P), and additionally, he encode P + 1 into G(P + 1) too, and write G(P) and G(P + 1) into his diary.<br>This story happened many years ago and now you hold the diary with these numbers in your hands. Unfortunately, some digits are unreadable now. Could you determine the values of these digits using the readable digits?</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first line has a number T (T &lt;= 100) , indicating the number of test cases.<br>For every test case, it has 2 lines of same number of digits describe G(P) and G(P + 1), In every line, it only contains 1, 0 and ?. Unreadable digits are denoted with symbol ?, The length of every line in the input is up to 10<sup>5</sup>.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For every case, you should output &quot;Case #t: &quot; at first, without quotes. The <i>t</i> is the case number starting from 1.<br>Then, if there is impossible to restore G(P) and G(P + 1), you should  output &quot;Impossible&quot; in the second line.<br>Otherwise, if G(P) is unique, you should output restored G(P) and G(P +1) in the same format.<br>Otherwise, you should output &quot;Ambiguous&quot; and the number of possible G(P) in the second line.<br><b>The number may be very large so the answer should modulo 10^9 + 7.</b><br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3
10??
10??
0010
0110
1?01
0?01</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case #1:
Ambiguous 3
Case #2:
0010
0110
Case #3:
Impossible
<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
In the first sample case, the three possible situations are:
1. 
G(12) = 1010
G(13) = 1011
2.  
G(13) = 1011
G(14) = 1001
3.  
G(14) = 1001
G(15) = 1000
</div><i style='font-size:1px'> </i></div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2013+ACM%2FICPC+Asia+Regional+Chengdu+Online&source=1&searchmode=source"> 2013 ACM/ICPC Asia Regional Chengdu Online </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>