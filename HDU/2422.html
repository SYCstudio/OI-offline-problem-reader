<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Essay Scoring System</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU2422. Essay Scoring System</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：10000/2000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Professor Binns has finally got tired of scoring essays himself and implemented an automatic essay scoring system to help him screen the numerous essays. Strongly against such an idea, you decided to generate a meaningless essay which can get high mark in his system to prove that his system does not work at all. You've obtained the rules used by Binns's system to score the essay, they're as follows:<br>&nbsp;&nbsp;&nbsp;&nbsp;a)&nbsp;&nbsp;The word in the essay must be from a particular set of words. If not, the essay will receive a score zero and is automatically rejected.<br>&nbsp;&nbsp;&nbsp;&nbsp;b)&nbsp;&nbsp;Every word in the specified set has a positive integer associated with it, indicating the score the submitter will get for using that word once.<br>&nbsp;&nbsp;&nbsp;&nbsp;c)&nbsp;&nbsp;A word can be used in several different ways; for example, in English, the word “word” can be used as both a noun and a verb. Every occurrence of specific patterns (like verb – adjective – noun) will earn the submitter a particular score.<br>&nbsp;&nbsp;&nbsp;&nbsp;In particular, it is allowed for a word to be interpreted in different ways in different patterns.<br>You're interested in generating an essay of a specified length with maximum possible score. <br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">There are multiple test cases in the input file. Each test case starts with three integers N, M and K, (1 &lt;= N &lt;= 100, 0 &lt;= M &lt;= 8, 0 &lt;= K &lt;= 6), the length of the essay to generate, the number of words in the dictionary and the number of patterns, respectively. The following M lines describe the words in the dictionary; each line consists of two integers, W<sub>i</sub>, and T<sub>i</sub>, (0 &lt;= W<sub>i</sub> &lt;= 2000, 1 &lt;= T<sub>i</sub> &lt;= 5), representing the score submitter gets every time he/she uses the word, and the number of ways the word can be used. The next part of the input describes the patterns. Each of the K lines describes one pattern, beginning with two integers, W<sub>i</sub>, and C<sub>i</sub>, (0 &lt;= W<sub>i</sub> &lt;= 2000, 1 &lt;= C<sub>i</sub> &lt;= 6), indicating the score one can get every time the pattern is used, and the number of consecutive parts in the pattern; followed by C<sub>i</sub> integers describing the language parts in the pattern. It is guaranteed that the total number of ways to use a word does not exceed 5; furthermore, the total number of parts contained in all patterns (sum of all C<sub>i</sub>s) will not exceed 25.<br>There is a blank line after each test case. Input ends with End-of-File.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For every test case, you should output one integer on a separate line, the maximum score one can get, in the format as indicated in the sample output.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2 3 2
4 3 0 1 2
5 2 2 3
1 2 0 4
1 2 1 3
10 2 4 2

2 3 2
4 3 0 1 2
5 2 2 3
1 2 0 4
1 2 1 3
2 2 4 2</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case 1: 16
Case 2: 10 </div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2008+Asia+Hangzhou+Regional+Contest+Online&source=1&searchmode=source"> 2008 Asia Hangzhou Regional Contest Online </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>