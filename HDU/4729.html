<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>An Easy Problem for Elfness</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU4729. An Easy Problem for Elfness</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：5000/2500 MS (Java/Others)</span> <span class="ui label">时间限制：65535/65535 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Pfctgeorge is totally a tall rich and handsome guy. He plans to build a huge water transmission network that covers the whole southwest China. To save the fund, there will be exactly one path between two cities.<br><br>Since the water every city provides and costs every day is different, he needs to transfer water from one particular city to another as much as possible in the next few days. However the pipes which connect the cities have a limited capacity for transmission. (Which means the water that transfer though the pipe should not exceed a particular amount) So he has to know the maximum water that the network can transfer in the next few days.<br><br>He thought it's a maximum flow problem, so he invites an expert in this field, Elfness (Also known as Xinhang senior sister) to help him figure it out.<br><br>Unlike Pfctgeorge, Elfness quickly finds that this problem is much easier than a normal maximum flow problem, and is willing to help Pfctgeorge.<br><br>&quot;Oh well, this problem is not a tough one. We can ...&quot;<br><br>Abruptly, Pfctgeorge's iPhone rings, and ... the ringtone is Mo Di Da Biao Ke.<br><br>&quot;You can make that? Excellent! &quot;Pfctgeorge hangs up his iPhone, and turns to Elfness.<br><br>&quot;Here's good news for you. A construction team told me that every pipe's capacity can be extended for one day. And the price for extending one unit capacity varies from day to day. &quot;<br><br>&quot;Eh well, that's a good news for you, not me. Now it's rather like a minimum cost ow problem, right? But it's still not a tough one, let me have a think. &quot;<br><br>After a few seconds' thought, Elfness comes up with a simple solution.<br><br>&quot;Ok, we can solve it like... &quot;<br><br>Abruptly, here comes Mo Di Da Biao Ke again.<br><br>&quot;Seriously? You can build new pipes? Thank you very much. &quot;<br><br>&quot;OK, my dear Elfness, we got more good news. Another construction team said they can build one or more pipes between any two cities and their pipes are exactly like the original ones except that they only work for one day. And the capacity of the new pipes is only one, but they can be extended, too. Of course, their price to build a single pipe also varies in days. &quot;<br><br>&quot;You mean the new pipes can be extended too? Wow, things are getting more interesting. Give me a few minutes. &quot;<br><br>Elfness takes out his new ultrabook which is awarded in VK cup and does some basic calculation.<br><br>&quot;I get it. The problem can be solved ...&quot;<br><br>Mo Di Da Biao Ke again, but this time it's from Elfness's phone.<br><br>&quot;As you see, I have to go out. But I know someone else who can also solve this; I'll recommend this guy for you. &quot;<br><br>And of course, that poor guy is YOU. Help Pfctgeorge solve his problem, and then the favorability about you from Elfness will raise a lot.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first line has a number T (T &lt;= 10) , indicating the number of test cases.<br><br>The first line of each test case is two integers N (1 &lt;= N &lt;= 100000) and M (1 &lt;= M &lt;= 100000), indicating the number of the city that the original network connects and the number of days when Pfctgeorge needs to know about the maximum water transmissions. Then next N - 1 lines each describe a pipe that connects two cities. The format will be like U, V , cap (1 &lt;= U, V &lt;= N and 0 &lt;= cap &lt; 10000), which means the ids of the two cities the pipe connects and the transmission limit of the pipe. As is said in description, the network that the cities and pipes form is a tree (an undirected acyclic graph).<br><br>Then next M lines of the test case describe the information about the next few days. The format is like<b> S, T, K, A, B(0 &lt;= K &lt;= 2^31 - 1, 1 &lt;= A, B &lt;= 2^31 - 1)</b>. S means the source of the water while T means the sink. K means the total budget in the day. A means the cost for a construction team to build a new pipe and B means the cost for a construction team to extend the capacity of a pipe.<br><br>I am glad to list the information of building a new pipe and extending the capacity.<br><br>1. Pfctgeorge can build a new pipe between any two cities, no matter they have been directly connected or not. Pfctgeorge can build more than one new pipe between any two cities.<br>2. The capacity of the pipe that was newly built is <b>one</b>.<br>3. Pfctgeorge can extend the capacity of any existed pipe including the newly built one and the original one.<br>4. Each time you extend the capacity of one pipe, the capacity of that pipe increases one.<br>5. The cost of building a new pipe is A and the cost of extending a pipe is B.<br>6. You can take any constructions in any times and the only limit is to make sure the total costs not exceed the budget.<br>7. <b>All the work that construction team does only lasts one single day.</b><br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For every case, you should output &quot;Case #t:&quot; at first, without quotes. The t is the case number starting from 1.<br>Then for each day, output the maximum water Pfctgeorge can transfer from S and T with a budget of K.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2
5 1
1 2 2
1 3 5
2 4 1
4 5 2
1 5 3 3 2
5 5
1 2 10
2 3 2
3 4 7
2 5 7
1 5 0 1 3
1 3 0 2 3
1 5 3 2 3
1 2 7 3 1
1 3 2 3 1</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case #1:
2
Case #2:
7
2
8
17
4
<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
In the first sample case, you can extend the capacity of the pipe which connects <i>city2</i> and <i>city4</i> by one, or just build a new pipe between <i>city2</i> and <i>city4</i>. </div><i style='font-size:1px'> </i></div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2013+ACM%2FICPC+Asia+Regional+Chengdu+Online&source=1&searchmode=source"> 2013 ACM/ICPC Asia Regional Chengdu Online </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>