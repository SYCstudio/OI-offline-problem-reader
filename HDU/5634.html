<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Rikka with Phi</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU5634. Rikka with Phi</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：16000/8000 MS (Java/Others)</span> <span class="ui label">时间限制：131072/131072 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">Rikka and Yuta are interested in Phi function (which is known as Euler's totient function).<br><br>Yuta gives Rikka an array $A[1..n]$ of positive integers,  then Yuta makes $m$ queries.  <br><br>There are three types of queries: <br><br>$ 1   \; l  \; r $ <br><br>Change $A[i]$  into $\varphi(A[i])$, for all $i \in [l, r]$.<br><br>$ 2   \; l  \; r  \; x$ <br><br>Change $A[i]$ into $x$, for all $i \in [l, r]$.<br><br>$ 3   \; l  \; r $ <br><br>Sum up $A[i]$, for all $i \in [l, r]$.<br><br>Help Rikka by computing the results of queries of type 3.<br><br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">The first line contains a number $T(T \leq 100)$ ——The number of the testcases. And there are no more than 2 testcases with $n &gt; 10 ^ 5$<br><br>For each testcase, the first line contains two numbers $n,m(n \leq 3 \times 10^5, m \leq 3 \times 10^5)$。<br><br>The second line contains $n$ numbers $A[i]$<br><br>Each of the next $m$ lines contains the description of the query. <br><br>It is guaranteed that $1 \leq A[i] \leq 10^7$ At any moment.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">For each query of type 3, print one number which represents the answer.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1
10 10
56 90 33 70 91 69 41 22 77 45
1 3 9
1 1 10
3 3 8
2 5 6 74
1 1 8
3 1 9
1 2 10
1 4 9
2 8 8 69
3 3 9</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">80
122
86</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=BestCoder+Round+%2373+%28div.1%29&source=1&searchmode=source"> BestCoder Round #73 (div.1) </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>