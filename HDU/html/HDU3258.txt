<html><head><meta name=keywords content="HDOJ ACM ICPC OJ C C++ Pascal Java"><meta http-equiv=Content-Type content="text/html;charset=gb2312"><link rel=stylesheet type=text/css href="/images/global.css" media=all><link rel=stylesheet type=text/css href="/css/diyinhead.css" media=all><link rel=stylesheet type=text/css href="/css/webinhead.css" media=all><script src="/js/global.js" type=text/javascript></script><script src="/js/register.js" type=text/javascript></script><script src="/js/MathJax/MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><title>Problem - 3258</title></head><body >
<a name=top></a>
<table align=center cellSpacing=0 cellPadding=0 width=980 border=0 style="word-wrap:break-word">
<tr>
	<td style="border:#1A5CC8 1px solid" align=center width=100%>
		<a href="/">
			<img src="/images/banner.jpg" width="100%" height=116 border=0>
		</a>
	</td>
</tr>
<tr>
	<td style="border:#1A5CC8 1px solid">
	<table cellSpacing=0 cellPadding=1 width="979px">
	<tr bgcolor=#1A5CC8 align=center class=banner height=25>
		<td>Online Judge</td>
		<td>Online Exercise</td>
		<td>Online Teaching</td>
		<td>Online Contests</td>
	<td>Exercise Author</td>
	</tr>
	<tr style="font-size:16px" align=center>
		<td width=20% valign=top>
		<a href="/faq.php" style="text-decoration: none">F.A.Q</a><br>
		<a href="/friends" style="text-decoration: none">Hand In Hand</a><br>
		<a href="/onlineuser.php" style="text-decoration: none">Online Acmers</a>	<br>
		<!-- /onlineuser.php-->
		
		<a href="/forum" style="text-decoration: none">Forum | </a><a href="/discuss/public/list.php" style="text-decoration: none">Discuss</a><br>
		<a href="/statistic/submit_graph.php" style="text-decoration: none">Statistical Charts</a><br>
		</td>
		<td width=20% valign=top>
		<form action="/search.php" method=get>
		<a href="/listproblem.php?vol=1" style="text-decoration: none">Problem Archive</a><br/>
		<!--<a href="http://feeds.feedburner.com/Hdoj-problemset"><img src="/images/rss1.jpg" alt="problemset" style="vertical-align:text-bottom;"width=20 height=20></a><br>-->
		<!--
			 <a href="/submit.php">Submit Solution</a><br>
		-->	
		<a href="/status.php" style="text-decoration: none">Realtime Judge Status</a><br>

		<a href="/ranklist.php" style="text-decoration: none">Authors Ranklist</a><br>
		<input name=field value=author type=hidden><input class=text60 name=key>&nbsp;<input class=button40 type=submit value=Search>
		
		<!--
			<input name=field value=problem type=hidden><input class=text60 name=key>&nbsp;<input class=button40 type=submit value=Search>
		-->
		</form>
		</td>
		<td width=20% valign=top>
		 <form action='/search.php' method=get> 
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a style="text-decoration: none" href="http://code.hdu.edu.cn/">C/C++/Java Exams &nbsp;&nbsp;&nbsp;&nbsp;</a><br/>
		<a style="text-decoration: none" href="/game">ACM Steps</a><br/>
		<a href = "/ITJobs/">Go to Job</a><br/>	
		<a href="/livecast" style="text-decoration: none">Contest LiveCast</a><br/>
		<a style="text-decoration: none" href="/region">ICPC@China</a><br/>
		<!-- <a href="/register.php">Register New Author</a><br> -->
		<!-- <a href="/modifyuser.php">Update Your Information</a><br> -->
		</form>
		</td>
		<td width=20% valign=top>
		<a href="http://bestcoder.hdu.edu.cn" style="text-decoration: none; color: red; font-weight: bold;">Best Coder <sup style="color: gray;">beta</sup></a><br/><a href="/vip/contest_list.php" style="text-decoration: none">VIP</a> | <a href="/contests/contest_list.php" style="text-decoration: none">STD Contests</a><br /><a href="http://code.hdu.edu.cn/vcontest" style="text-decoration: none">Virtual Contests </a><br/>&nbsp;&nbsp;<a href="/diy/contest_list.php" style="text-decoration: none">&nbsp;&nbsp;DIY | </a><a href="/webcontest" style="text-decoration: none"><font color="">Web-DIY</font> <font size=1 color="gray"><sup>beta</sup></font></a><br/><a style="text-decoration: none" href="/recentcontest">Recent Contests</a><br/>		</td>
		<td width=20%>
					<form method=post action="/userloginex.php?action=login">
			  <table width=168 border=0 align=center cellspacing=0>
			  	<tr><td align=center colspan=2><a href="/qqlogin/oauth/login.php"><img src="/qqlogin/images/qqlogin.png" border="0" /></a></td></tr>
				<tr><td width=68>Author ID&nbsp;</td><td align=right><input name=username type=text class=text90 maxlength=20></td></tr>
				<tr><td>Password&nbsp;</td><td align=right><input name=userpass type=password class=text90 maxlength=20></td></tr>
			  </table>
			  <input name=login type=submit class=button40 value="Sign In">&nbsp;<a href="http://bestcoder.hdu.edu.cn/register.php?url=acm.hdu.edu.cn/userloginex.php?action=login" style="text-decoration: none">Register new ID</a>
			</form>
						</td>
	</tr>
	</table>
	</td>
</tr>
<tr>
	<td>
		<div align=center id=rollword><marquee scrollamount=2 width=600 scrolldelay=30 onMouseOver="javascript:this.stop();" onMouseOut="javascript:this.start();"><b style="margin-right:20px"></b></marquee></div>	</td>
</tr>
<tr><td align=center><h1 style='color:#1A5CC8'>Intricate to death?</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 99&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 6<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Have you heard of the game PAL? Many people believe it's the greatest Chinese RPG series so far. There are many characters, including heros and NPCs, summarized in the following paragraph.<br>李 逍 遥：一代主角。<br>赵 灵 儿：一代主角的妻子。<br>李 三 思：一代主角的爸爸。<br>李 忆 如：一代主角的女儿。<br>酒 剑 仙：一代主角的师父。<br>王 小 虎：一代主角的邻居。<br>林 月 如：一代主角的第一个知己。<br>阿　　奴：一个主角的第二个知己。<br>林 青 儿：一代主角的妻子的妈妈。<br>巫　　王：一代主角的妻子的爸爸。<br>景　　天：一代主角的爸爸的师父。<br>独孤剑圣：一代主角的师父的师兄。<br>喻 南 松：一代主角的邻居的朋友。<br>圣　　姑：一代主角的妻子的守护人。<br>沈 欺 霜：一代主角的邻居的女朋友。<br>千叶禅师：一代主角的邻居的朋友的师父。<br>紫　　萱：一代主角的妻子的妈妈的妈妈。<br>铁掌飞凤：一代主角的爸爸的弟弟的妻子。<br>龙　　葵：一代主角的爸爸的师父的前世的妹妹。<br>飞　　蓬：一代主角的爸爸的师父的前世的前世。<br>徐 长 卿：一代主角的妻子的妈妈的妈妈的丈夫的转世。<br>夕　　瑶：一代主角的爸爸的师父的前世的前世的女朋友。<br>清　　微：一代主角的妻子的妈妈的妈妈的丈夫的转世的师父。<br>周 赤 炎：一代主角的妻子的妈妈的妈妈所救的狼妖的人的身份。<br>燎　　日：一代主角的妻子的妈妈的妈妈所救的狼妖的妖的身份。<br>慕容紫英：一代主角的爸爸的师父的前世铸的剑的第一个发现者。<br>苏　　媚：一代主角和一代主角的第一个知己所杀的妖怪的孩子。<br>云 天 河：一代主角的爸爸的师父的前世铸的剑的第一个发现者的师侄。<br>拜月教主：一代主角和一代主角的妻子和一代主角的妻子的妈妈的仇人。<br>云 天 青：一代主角的爸爸的师父的前世铸的剑的第一个发现者的师侄的爸爸。<br>怀　　朔：一代主角的爸爸的师父的前世铸的剑的第一个发现者的师侄的师兄。<br>璇　　玑：一代主角的爸爸的师父的前世铸的剑的第一个发现者的师侄的师姐。<br>韩 菱 纱：一代主角的爸爸的师父的前世铸的剑的第一个发现者的师侄的女朋友。<br>玄　　霄：一代主角的爸爸的师父的前世铸的剑的第一个发现者的师侄的爸爸的师兄。<br>夙　　玉：一代主角的爸爸的师父的前世铸的剑的第一个发现者的师侄的爸爸的妻子。<br>南 宫 煌：一代主角的妻子的妈妈的妈妈所救的狼妖的人的身份的两个儿子中的弟弟。<br>星　　璇：一代主角的妻子的妈妈的妈妈所救的狼妖的人的身份的两个儿子中的哥哥。<br>重　　楼：一代主角的爸爸的师父和一代主角的爸爸的师父的前世的前世的朋友兼敌人。<br>柳 梦 璃：一代主角的爸爸的师父的前世铸的剑的第一个发现者的师侄的爸爸所救的女妖。<br>思　　堂：一代主角的妻子的妈妈的妈妈所救的狼妖的人的身份的两个儿子中的哥哥的朋友。<br>王 蓬 絮：一代主角的妻子的妈妈的妈妈所救的狼妖的人的身份的两个儿子中的哥哥的女朋友。<br>温　　慧：一代主角的妻子的妈妈的妈妈所救的狼妖的人的身份的两个儿子中的弟弟的女朋友。<br>雪　　见：一代主角的爸爸的师父的前世的前世的女朋友给一代主角的爸爸的师父做的女朋友。<br>婵　　幽：一代主角的爸爸的师父的前世铸的剑的第一个发现者的师侄的爸爸所救的女妖的妈妈。<br>花　　楹：一代主角的爸爸的师父的前世的前世的女朋友给一代主角的爸爸的师父做的女朋友的宠物。<br>温　　策：一代主角的妻子的妈妈的妈妈所救的狼妖的人的身份的两个儿子中的弟弟的女朋友的哥哥。<br>归　　邪：一代主角的爸爸的师父的前世铸的剑的第一个发现者的师侄的爸爸所救的女妖的妈妈的手下武将。<br>奚　　仲：一代主角的爸爸的师父的前世铸的剑的第一个发现者的师侄的爸爸所救的女妖的妈妈的手下文官。<br><br>Obviously, some of the descriptions are deliberately lengthened, in order to make the whole paragraph more fun.<br>In this problem, your task is similar: given a set of rules, find a description that is at least A characters and at most B characters long.<br>If there are more than one possible description satisfying the condition above, choose the one that comes first lexicographically. <br>Note that shorter answers are NOT always better than longer ones.<br>BTW: Rules like &quot;Lixiaoyao: Lixiaoyao&quot; looks rather stupid, so don't print things like that, even if no other solutions can be found.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line contains a single integer T (T &lt;= 10), the number of test cases. <br>Each case begins with an integer n (1 &lt;= n &lt;= 5), the number of rules, followed by n lines, each describing a rule. Each rule begins with the character's name, then a colon, then a single space, and the description. The description is a list of tokens separated by a single space, with no leading spaces or trailing spaces, followed by a period. Each token is either a word consisting of only lowercase letters, or a character's name, or a character's name, followed by an apostrophe('), then a lowercase letter 's'. A character's name is always an uppercase letter followed by zero or more lowercase letters. No two characters will have the same name, but not all character names appear in the left side of a rule. After the ruleset, you'll be given a single integer q (1 &lt;= q &lt;= 5) on the next line, indicating the number of queries. Each query appears on its own line, containing the name of the character in question, then two integers A and B (1 &lt;= A &lt;= B &lt;= 100), explained above. <br>Each rule is at least 15 characters, at most 100 characters, containing at least one lowercase token. On the right side of each rule, there will be at most 3 characters involved, all distinct (though one of them may appear on the left side of the rule), and there are no more than 10000 different descriptions for any character in questions, if we only count descriptions only length &lt;= B.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, print the case number in the first line, then q answers in the following q lines, one for each line.<br>If there is no solution, print 'No solution.' (without quote), otherwise a sentence describing the character. The sentence should be in the same format as a rule in the input. The length of the sentence (including everything: the character's name, the colon, the space, the description, and the final period) should be at least A and at most B.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
2
Alice: Bob's mother.
Bob: Alice's son.
2
Alice 20 20
Bob 24 25
4
A: B's girlfriend.
B: A's boyfriend.
C: the only person who knows that A and B love each other.
A: D's smallest daughter.
5
A 1 100
C 1 50
C 70 80
C 71 80
C 82 90</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1:
Alice: Bob's mother.
Bob: Bob's mother's son.
Case 2:
A: A's boyfriend's girlfriend.
No solution.
C: the only person who knows that A and A's boyfriend love each other.
C: the only person who knows that B's girlfriend and B love each other.
C: the only person who knows that A and B's girlfriend's boyfriend love each other.</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href="/search.php?field=problem&key=2009+Asia+Regional+Ningbo+Online&source=1&searchmode=source"> 2009 Asia Regional Ningbo Online </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>wujianhua</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3258'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3258'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3258">Discuss</a> | <a href='note/note.php?pid=3258'>Note</a><br></td></tr><tr>
<td>
	<table style="border:#1A5CC8 1px solid; font-size:14px" cellSpacing=0 cellPadding=1 width=100%>
	<tr align=center>
		<td class=footer_link height=45><a href="/">Home</a> | <a href=#top>Top</a></td>
		<td style="padding:6px">
			Hangzhou Dianzi University Online Judge 3.0<br>
			Copyright &copy; 2005-2018 <a href=mailto:acm@hdu.edu.cn>HDU ACM Team</a>. All Rights Reserved.<br>
			<a href="../about_us/developer.php">Designer & Developer </a>: <a>Wang Rongtao</a>&nbsp<a>LinLe</a>&nbsp<a href=mailto:gjavac@gmail.com >GaoJie</a>&nbsp<a href=mailto:gl8997@gmail.com >GanLu</a><br>
			<span class=pagerunstatus>Total 0.000000(s) query 2, Server time : 2018-07-07 22:21:23, Gzip disabled</span>		</td>
		<td class=footer_link>
			<!-- <a href="javascript:history.go(-1);">Back</a> | <a href="javascript:history.forward();">Forward</a>-->
			<a href="/admin">Administration</a>	
		</td>
	</tr>
	</table>
</td>
</tr>
</table>
</body></html>
