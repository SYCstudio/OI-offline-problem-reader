<html><head><meta name=keywords content="HDOJ ACM ICPC OJ C C++ Pascal Java"><meta http-equiv=Content-Type content="text/html;charset=gb2312"><link rel=stylesheet type=text/css href="/images/global.css" media=all><link rel=stylesheet type=text/css href="/css/diyinhead.css" media=all><link rel=stylesheet type=text/css href="/css/webinhead.css" media=all><script src="/js/global.js" type=text/javascript></script><script src="/js/register.js" type=text/javascript></script><script src="/js/MathJax/MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><title>Problem - 4090</title></head><body >
<a name=top></a>
<table align=center cellSpacing=0 cellPadding=0 width=980 border=0 style="word-wrap:break-word">
<tr>
	<td style="border:#1A5CC8 1px solid" align=center width=100%>
		<a href="/">
			<img src="/images/banner.jpg" width="100%" height=116 border=0>
		</a>
	</td>
</tr>
<tr>
	<td style="border:#1A5CC8 1px solid">
	<table cellSpacing=0 cellPadding=1 width="979px">
	<tr bgcolor=#1A5CC8 align=center class=banner height=25>
		<td>Online Judge</td>
		<td>Online Exercise</td>
		<td>Online Teaching</td>
		<td>Online Contests</td>
	<td>Exercise Author</td>
	</tr>
	<tr style="font-size:16px" align=center>
		<td width=20% valign=top>
		<a href="/faq.php" style="text-decoration: none">F.A.Q</a><br>
		<a href="/friends" style="text-decoration: none">Hand In Hand</a><br>
		<a href="/onlineuser.php" style="text-decoration: none">Online Acmers</a>	<br>
		<!-- /onlineuser.php-->
		
		<a href="/forum" style="text-decoration: none">Forum | </a><a href="/discuss/public/list.php" style="text-decoration: none">Discuss</a><br>
		<a href="/statistic/submit_graph.php" style="text-decoration: none">Statistical Charts</a><br>
		</td>
		<td width=20% valign=top>
		<form action="/search.php" method=get>
		<a href="/listproblem.php?vol=1" style="text-decoration: none">Problem Archive</a><br/>
		<!--<a href="http://feeds.feedburner.com/Hdoj-problemset"><img src="/images/rss1.jpg" alt="problemset" style="vertical-align:text-bottom;"width=20 height=20></a><br>-->
		<!--
			 <a href="/submit.php">Submit Solution</a><br>
		-->	
		<a href="/status.php" style="text-decoration: none">Realtime Judge Status</a><br>

		<a href="/ranklist.php" style="text-decoration: none">Authors Ranklist</a><br>
		<input name=field value=author type=hidden><input class=text60 name=key>&nbsp;<input class=button40 type=submit value=Search>
		
		<!--
			<input name=field value=problem type=hidden><input class=text60 name=key>&nbsp;<input class=button40 type=submit value=Search>
		-->
		</form>
		</td>
		<td width=20% valign=top>
		 <form action='/search.php' method=get> 
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a style="text-decoration: none" href="http://code.hdu.edu.cn/">C/C++/Java Exams &nbsp;&nbsp;&nbsp;&nbsp;</a><br/>
		<a style="text-decoration: none" href="/game">ACM Steps</a><br/>
		<a href = "/ITJobs/">Go to Job</a><br/>	
		<a href="/livecast" style="text-decoration: none">Contest LiveCast</a><br/>
		<a style="text-decoration: none" href="/region">ICPC@China</a><br/>
		<!-- <a href="/register.php">Register New Author</a><br> -->
		<!-- <a href="/modifyuser.php">Update Your Information</a><br> -->
		</form>
		</td>
		<td width=20% valign=top>
		<a href="http://bestcoder.hdu.edu.cn" style="text-decoration: none; color: red; font-weight: bold;">Best Coder <sup style="color: gray;">beta</sup></a><br/><a href="/vip/contest_list.php" style="text-decoration: none">VIP</a> | <a href="/contests/contest_list.php" style="text-decoration: none">STD Contests</a><br /><a href="http://code.hdu.edu.cn/vcontest" style="text-decoration: none">Virtual Contests </a><br/>&nbsp;&nbsp;<a href="/diy/contest_list.php" style="text-decoration: none">&nbsp;&nbsp;DIY | </a><a href="/webcontest" style="text-decoration: none"><font color="">Web-DIY</font> <font size=1 color="gray"><sup>beta</sup></font></a><br/><a style="text-decoration: none" href="/recentcontest">Recent Contests</a><br/>		</td>
		<td width=20%>
					<form method=post action="/userloginex.php?action=login">
			  <table width=168 border=0 align=center cellspacing=0>
			  	<tr><td align=center colspan=2><a href="/qqlogin/oauth/login.php"><img src="/qqlogin/images/qqlogin.png" border="0" /></a></td></tr>
				<tr><td width=68>Author ID&nbsp;</td><td align=right><input name=username type=text class=text90 maxlength=20></td></tr>
				<tr><td>Password&nbsp;</td><td align=right><input name=userpass type=password class=text90 maxlength=20></td></tr>
			  </table>
			  <input name=login type=submit class=button40 value="Sign In">&nbsp;<a href="http://bestcoder.hdu.edu.cn/register.php?url=acm.hdu.edu.cn/userloginex.php?action=login" style="text-decoration: none">Register new ID</a>
			</form>
						</td>
	</tr>
	</table>
	</td>
</tr>
<tr>
	<td>
		<div align=center id=rollword><marquee scrollamount=2 width=600 scrolldelay=30 onMouseOver="javascript:this.stop();" onMouseOut="javascript:this.start();"><b style="margin-right:20px"></b></marquee></div>	</td>
</tr>
<tr><td align=center><h1 style='color:#1A5CC8'>GemAnd Prince</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 10000/5000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 1372&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 497<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Nowadays princess Claire wants one more guard and posts the ads throughout the kingdom. For her unparalleled beauty, generality, goodness and other virtues, many people gather at the capital and apply for the position. Because princess Claire is very clever, she doesn't want a fool to be her guard. As Claire is clever, she invents a game to test the applicants. The game is described as follows.<br>The game begins with a rectangular board of n rows and m columns, containing n*m grids. Each grid is filled with a gem and each gem is covered by one color, denoted by a number.(as the following shows).<br><center><img style='max-width:100%;' src=../../data/images/4090-1.jpg></center> <br><center><img style='max-width:100%;' src=../../data/images/4090-2.jpg></center> <br><center><img style='max-width:100%;' src=../../data/images/4090-3.jpg></center> <br><center><img style='max-width:100%;' src=../../data/images/4090-4.jpg></center> <br><br>If a gem has the same color with another one, and shares the same corner or the same border with it, the two are considered to be adjacent. Two adjacent gems are said to be connective. And we define that if A and B are connective, B and C are connective, then A and C are connective, namely the adjacency is transitive. Each time we can choose a gem and pick up all of the gems connected to it, including itself, and get a score equal to the square of the number of the gems we pick this time(but to make the game more challenging, the number of gems to be picked each time must be equal or larger than three).Another rule is that if one gem is picked, all the gems above it(if there is any)fall down to fill its grid,and if there is one column containing no gems at all, all the columns at its right(also if there is any) move left to fill the column. These rules can be shown as follows.<br><center><img style='max-width:100%;' src=../../data/images/4090-5.jpg></center> <br><br>As the picture [a] above,all the gems that has color 1 are connective. After we choose one of them to be picked, all the gems that are connected to it must also be picked together, as the picture [b] shows (here we use 0 to denote the holes generated by the absence of gems).<br>Then the rest gems fall, as shown in picture [c]. Then the rest gems move left, as shown in picture [d]. Because we picked six gems at this time, our score increases 6*6=36.And furthermore, because we cannot find another gem, which has at least three gems connected to it(including itself),to be picked, the game comes to an end.<br>Each applicant will face such a board and the one who gets the highest score will have the honor to serve princess Claire. <br>Aswmtjdsj also wants to serve for princess Claire. But he realizes that competing with so many people, even among whom there are powerful ACMers, apparently there is little chance to succeed. With the strong desire to be the lucky dog, Aswmtjdsj asks you for help. Can you help make his dream come true?</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are no more than 15 test cases, separated by a blank line, end with EOF. Each case has n+1 lines, the first line of a case has three integers n, m, k (1&lt;=n, m&lt;=8, 1&lt;=k&lt;=6). Each of the next n lines contains m integers. The integer at (i+1)th line and jth column denotes the color of the gem at the grid (i, j), where the grid(1, 1) denotes the top left one, while the grid(n, m) is the lower right one. The integer in the grid is among [1, k].</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each case you should output the highest score you can get in one single line.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3 3 3
1 1 3
1 2 1
1 1 2

5 4 3
2 2 3 3
1 1 3 3
3 2 2 2
3 1 1 1
3 1 2 2</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">36
103</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href="/search.php?field=problem&key=2011+Asia+Beijing+Regional+Contest+&source=1&searchmode=source"> 2011 Asia Beijing Regional Contest  </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=4090'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=4090'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=4090">Discuss</a> | <a href='note/note.php?pid=4090'>Note</a><br></td></tr><tr>
<td>
	<table style="border:#1A5CC8 1px solid; font-size:14px" cellSpacing=0 cellPadding=1 width=100%>
	<tr align=center>
		<td class=footer_link height=45><a href="/">Home</a> | <a href=#top>Top</a></td>
		<td style="padding:6px">
			Hangzhou Dianzi University Online Judge 3.0<br>
			Copyright &copy; 2005-2018 <a href=mailto:acm@hdu.edu.cn>HDU ACM Team</a>. All Rights Reserved.<br>
			<a href="../about_us/developer.php">Designer & Developer </a>: <a>Wang Rongtao</a>&nbsp<a>LinLe</a>&nbsp<a href=mailto:gjavac@gmail.com >GaoJie</a>&nbsp<a href=mailto:gl8997@gmail.com >GanLu</a><br>
			<span class=pagerunstatus>Total 0.000000(s) query 2, Server time : 2018-07-07 23:09:09, Gzip disabled</span>		</td>
		<td class=footer_link>
			<!-- <a href="javascript:history.go(-1);">Back</a> | <a href="javascript:history.forward();">Forward</a>-->
			<a href="/admin">Administration</a>	
		</td>
	</tr>
	</table>
</td>
</tr>
</table>
</body></html>
