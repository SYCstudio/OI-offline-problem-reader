<html><head><meta name=keywords content="HDOJ ACM ICPC OJ C C++ Pascal Java"><meta http-equiv=Content-Type content="text/html;charset=gb2312"><link rel=stylesheet type=text/css href="/images/global.css" media=all><link rel=stylesheet type=text/css href="/css/diyinhead.css" media=all><link rel=stylesheet type=text/css href="/css/webinhead.css" media=all><script src="/js/global.js" type=text/javascript></script><script src="/js/register.js" type=text/javascript></script><script src="/js/MathJax/MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><title>Problem - 3716</title></head><body >
<a name=top></a>
<table align=center cellSpacing=0 cellPadding=0 width=980 border=0 style="word-wrap:break-word">
<tr>
	<td style="border:#1A5CC8 1px solid" align=center width=100%>
		<a href="/">
			<img src="/images/banner.jpg" width="100%" height=116 border=0>
		</a>
	</td>
</tr>
<tr>
	<td style="border:#1A5CC8 1px solid">
	<table cellSpacing=0 cellPadding=1 width="979px">
	<tr bgcolor=#1A5CC8 align=center class=banner height=25>
		<td>Online Judge</td>
		<td>Online Exercise</td>
		<td>Online Teaching</td>
		<td>Online Contests</td>
	<td>Exercise Author</td>
	</tr>
	<tr style="font-size:16px" align=center>
		<td width=20% valign=top>
		<a href="/faq.php" style="text-decoration: none">F.A.Q</a><br>
		<a href="/friends" style="text-decoration: none">Hand In Hand</a><br>
		<a href="/onlineuser.php" style="text-decoration: none">Online Acmers</a>	<br>
		<!-- /onlineuser.php-->
		
		<a href="/forum" style="text-decoration: none">Forum | </a><a href="/discuss/public/list.php" style="text-decoration: none">Discuss</a><br>
		<a href="/statistic/submit_graph.php" style="text-decoration: none">Statistical Charts</a><br>
		</td>
		<td width=20% valign=top>
		<form action="/search.php" method=get>
		<a href="/listproblem.php?vol=1" style="text-decoration: none">Problem Archive</a><br/>
		<!--<a href="http://feeds.feedburner.com/Hdoj-problemset"><img src="/images/rss1.jpg" alt="problemset" style="vertical-align:text-bottom;"width=20 height=20></a><br>-->
		<!--
			 <a href="/submit.php">Submit Solution</a><br>
		-->	
		<a href="/status.php" style="text-decoration: none">Realtime Judge Status</a><br>

		<a href="/ranklist.php" style="text-decoration: none">Authors Ranklist</a><br>
		<input name=field value=author type=hidden><input class=text60 name=key>&nbsp;<input class=button40 type=submit value=Search>
		
		<!--
			<input name=field value=problem type=hidden><input class=text60 name=key>&nbsp;<input class=button40 type=submit value=Search>
		-->
		</form>
		</td>
		<td width=20% valign=top>
		 <form action='/search.php' method=get> 
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a style="text-decoration: none" href="http://code.hdu.edu.cn/">C/C++/Java Exams &nbsp;&nbsp;&nbsp;&nbsp;</a><br/>
		<a style="text-decoration: none" href="/game">ACM Steps</a><br/>
		<a href = "/ITJobs/">Go to Job</a><br/>	
		<a href="/livecast" style="text-decoration: none">Contest LiveCast</a><br/>
		<a style="text-decoration: none" href="/region">ICPC@China</a><br/>
		<!-- <a href="/register.php">Register New Author</a><br> -->
		<!-- <a href="/modifyuser.php">Update Your Information</a><br> -->
		</form>
		</td>
		<td width=20% valign=top>
		<a href="http://bestcoder.hdu.edu.cn" style="text-decoration: none; color: red; font-weight: bold;">Best Coder <sup style="color: gray;">beta</sup></a><br/><a href="/vip/contest_list.php" style="text-decoration: none">VIP</a> | <a href="/contests/contest_list.php" style="text-decoration: none">STD Contests</a><br /><a href="http://code.hdu.edu.cn/vcontest" style="text-decoration: none">Virtual Contests </a><br/>&nbsp;&nbsp;<a href="/diy/contest_list.php" style="text-decoration: none">&nbsp;&nbsp;DIY | </a><a href="/webcontest" style="text-decoration: none"><font color="">Web-DIY</font> <font size=1 color="gray"><sup>beta</sup></font></a><br/><a style="text-decoration: none" href="/recentcontest">Recent Contests</a><br/>		</td>
		<td width=20%>
					<form method=post action="/userloginex.php?action=login">
			  <table width=168 border=0 align=center cellspacing=0>
			  	<tr><td align=center colspan=2><a href="/qqlogin/oauth/login.php"><img src="/qqlogin/images/qqlogin.png" border="0" /></a></td></tr>
				<tr><td width=68>Author ID&nbsp;</td><td align=right><input name=username type=text class=text90 maxlength=20></td></tr>
				<tr><td>Password&nbsp;</td><td align=right><input name=userpass type=password class=text90 maxlength=20></td></tr>
			  </table>
			  <input name=login type=submit class=button40 value="Sign In">&nbsp;<a href="http://bestcoder.hdu.edu.cn/register.php?url=acm.hdu.edu.cn/userloginex.php?action=login" style="text-decoration: none">Register new ID</a>
			</form>
						</td>
	</tr>
	</table>
	</td>
</tr>
<tr>
	<td>
		<div align=center id=rollword><marquee scrollamount=2 width=600 scrolldelay=30 onMouseOver="javascript:this.stop();" onMouseOut="javascript:this.start();"><b style="margin-right:20px"></b></marquee></div>	</td>
</tr>
<tr><td align=center><h1 style='color:#1A5CC8'>Jenga</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 4000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/65536 K (Java/Others)<br>Total Submission(s): 225&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 117<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>In their spare time of training, Alice and Charles often play Jenga together. As they've played the game together so many times, they both know each others' performance as well as themselves'. Now with their success rate of each move provided, can you tell in what probability each of them will win? And of course, Alice and Charles, like other ACM-ICPC contestants such as you, are very clever.<br><br>Jenga is a game of physical and mental skill. In Jenga, players take turns to remove a block from a tower and balance it on top, creating a taller and increasingly unstable structure as the game progresses.<br><br><center><img style='max-width:100%;' src=../../data/images/3716-1.jpg></center><br><br>Jenga is played with 54 wooden blocks. Each block is three times as long as it is wide. To set up the game, the included loading tray is used to stack the initial tower which has 18 levels of three blocks placed adjacent to each other along their long side and perpendicular to the previous level (so, for example, if the blocks in the first level lie lengthwise north-south, the second level blocks will lie east-west).<br>Once the tower is built, the players take turns to move. Moving in Jenga consists of taking one and only one block from any level (except those mentioned later) of the tower, and placing it on the topmost level in order to complete it. The blocks in the top level, and the level below it if the top level is not completed, cannot be removed. However, if the top level is completed, the blocks in the one below it can be removed. The removed block should be placed to make the top level as same as the other level (with no block removed). The move is successful if the tower does not fall. The game ends when the tower falls, or no block can be removed without making the tower fall (rarely happened). And the loser is the player who made the tower fall (i.e., whose turn it was when the tower fell), or who cannot make the move.<br><br><center><img style='max-width:100%;' src=../../data/images/3716-2.jpg></center><br><br>Now let's consider each level of the tower, there're only four types of valid arrangement of wooden blocks, as illustrated above. At the beginning of the game, they're all of the type A (or rotated by 90 degrees). And by removing a block from type A, one will get either type B or type C (or the mirrored equivalent of type C). No block from type B can be removed without making the tower fall. From type C we can only remove a block and result in type D. Then no block can be removed further. So there are only three types of moves: (1) A -&gt; B, (2) A -&gt; C and (3) C -&gt; D, in addition to adding the removed block to the top level.<br>As Alice and Charles have played Jenga so many times, their success rate of each move is very stable and can be formulated as P = b - d*n, where b is the player's base success rate of this type of move, d is the decrease of success rate for each additional level, and n is the number of levels in the tower before this move. The incomplete top level also counts as one level. For example, if the game begins with 18 levels, and both players have the same performance with b = 2.8 and d = 0.1, then P will be 1.0 for the first turn, and become 0.9 between the 2nd and the 4th turns. If P does not lie in the range [0, 1], the nearest number in the range is indicated. (E.g. when a player cannot fail the first several moves, P will be more than 1 until n is a bit larger.) </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input file contains multiple test cases. The first line of the input file is a single integer T (T ≤ 500), the number of test cases.<br>Each test cases begins with a line of n<sub>0</sub> (3 ≤ n<sub>0</sub> ≤ 18), the number of levels in the tower when the game starts. (When n<sub>0</sub> is not 18, the rule sare the same.) The second line contains 6 real numbers b<sub>a1</sub>, d<sub>a1</sub>, b<sub>a2</sub>, d<sub>a2</sub>, b<sub>a3</sub>, d<sub>a3</sub>, indicating Alice's base success rates and the decreases of success rates for each of the three moves: (1) A -&gt; B, (2) A -&gt; C and (3) C -&gt; D. The third line also contains 6 real numbers b<sub>c1</sub>, d<sub>c1</sub>, b<sub>c2</sub>, d<sub>c2</sub>, b<sub>c3</sub>, d<sub>c3</sub>, those of Charles. (0 ≤ b - d*n<sub>0</sub> ≤ 2 and 0 &lt; d ≤ 0.5 for all the 6 pairs of parameters. No real number will have more than 4 digits after the decimal point.)</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, print a line with Alice's winning probability, assume that she always moves first. Your answer should be rounded to the 4th digit after the decimal point.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
3
1.3 0.1 1.3 0.1 1.3 0.1
1.3 0.1 1.3 0.1 1.3 0.1
4
1.5 0.1 1.5 0.1 1.5 0.1
1.5 0.1 1.5 0.1 1.5 0.1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">0.1810
0.8190</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>XIAO, Dong</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href="/search.php?field=problem&key=2010+Asia+Chengdu+Regional+Contest&source=1&searchmode=source"> 2010 Asia Chengdu Regional Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>zhouzeyong</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3716'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3716'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3716">Discuss</a> | <a href='note/note.php?pid=3716'>Note</a><br></td></tr><tr>
<td>
	<table style="border:#1A5CC8 1px solid; font-size:14px" cellSpacing=0 cellPadding=1 width=100%>
	<tr align=center>
		<td class=footer_link height=45><a href="/">Home</a> | <a href=#top>Top</a></td>
		<td style="padding:6px">
			Hangzhou Dianzi University Online Judge 3.0<br>
			Copyright &copy; 2005-2018 <a href=mailto:acm@hdu.edu.cn>HDU ACM Team</a>. All Rights Reserved.<br>
			<a href="../about_us/developer.php">Designer & Developer </a>: <a>Wang Rongtao</a>&nbsp<a>LinLe</a>&nbsp<a href=mailto:gjavac@gmail.com >GaoJie</a>&nbsp<a href=mailto:gl8997@gmail.com >GanLu</a><br>
			<span class=pagerunstatus>Total 0.000000(s) query 2, Server time : 2018-07-07 22:52:59, Gzip disabled</span>		</td>
		<td class=footer_link>
			<!-- <a href="javascript:history.go(-1);">Back</a> | <a href="javascript:history.forward();">Forward</a>-->
			<a href="/admin">Administration</a>	
		</td>
	</tr>
	</table>
</td>
</tr>
</table>
</body></html>
