<html><head><meta name=keywords content="HDOJ ACM ICPC OJ C C++ Pascal Java"><meta http-equiv=Content-Type content="text/html;charset=gb2312"><link rel=stylesheet type=text/css href="/images/global.css" media=all><link rel=stylesheet type=text/css href="/css/diyinhead.css" media=all><link rel=stylesheet type=text/css href="/css/webinhead.css" media=all><script src="/js/global.js" type=text/javascript></script><script src="/js/register.js" type=text/javascript></script><script src="/js/MathJax/MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><title>Problem - 3904</title></head><body >
<a name=top></a>
<table align=center cellSpacing=0 cellPadding=0 width=980 border=0 style="word-wrap:break-word">
<tr>
	<td style="border:#1A5CC8 1px solid" align=center width=100%>
		<a href="/">
			<img src="/images/banner.jpg" width="100%" height=116 border=0>
		</a>
	</td>
</tr>
<tr>
	<td style="border:#1A5CC8 1px solid">
	<table cellSpacing=0 cellPadding=1 width="979px">
	<tr bgcolor=#1A5CC8 align=center class=banner height=25>
		<td>Online Judge</td>
		<td>Online Exercise</td>
		<td>Online Teaching</td>
		<td>Online Contests</td>
	<td>Exercise Author</td>
	</tr>
	<tr style="font-size:16px" align=center>
		<td width=20% valign=top>
		<a href="/faq.php" style="text-decoration: none">F.A.Q</a><br>
		<a href="/friends" style="text-decoration: none">Hand In Hand</a><br>
		<a href="/onlineuser.php" style="text-decoration: none">Online Acmers</a>	<br>
		<!-- /onlineuser.php-->
		
		<a href="/forum" style="text-decoration: none">Forum | </a><a href="/discuss/public/list.php" style="text-decoration: none">Discuss</a><br>
		<a href="/statistic/submit_graph.php" style="text-decoration: none">Statistical Charts</a><br>
		</td>
		<td width=20% valign=top>
		<form action="/search.php" method=get>
		<a href="/listproblem.php?vol=1" style="text-decoration: none">Problem Archive</a><br/>
		<!--<a href="http://feeds.feedburner.com/Hdoj-problemset"><img src="/images/rss1.jpg" alt="problemset" style="vertical-align:text-bottom;"width=20 height=20></a><br>-->
		<!--
			 <a href="/submit.php">Submit Solution</a><br>
		-->	
		<a href="/status.php" style="text-decoration: none">Realtime Judge Status</a><br>

		<a href="/ranklist.php" style="text-decoration: none">Authors Ranklist</a><br>
		<input name=field value=author type=hidden><input class=text60 name=key>&nbsp;<input class=button40 type=submit value=Search>
		
		<!--
			<input name=field value=problem type=hidden><input class=text60 name=key>&nbsp;<input class=button40 type=submit value=Search>
		-->
		</form>
		</td>
		<td width=20% valign=top>
		 <form action='/search.php' method=get> 
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a style="text-decoration: none" href="http://code.hdu.edu.cn/">C/C++/Java Exams &nbsp;&nbsp;&nbsp;&nbsp;</a><br/>
		<a style="text-decoration: none" href="/game">ACM Steps</a><br/>
		<a href = "/ITJobs/">Go to Job</a><br/>	
		<a href="/livecast" style="text-decoration: none">Contest LiveCast</a><br/>
		<a style="text-decoration: none" href="/region">ICPC@China</a><br/>
		<!-- <a href="/register.php">Register New Author</a><br> -->
		<!-- <a href="/modifyuser.php">Update Your Information</a><br> -->
		</form>
		</td>
		<td width=20% valign=top>
		<a href="http://bestcoder.hdu.edu.cn" style="text-decoration: none; color: red; font-weight: bold;">Best Coder <sup style="color: gray;">beta</sup></a><br/><a href="/vip/contest_list.php" style="text-decoration: none">VIP</a> | <a href="/contests/contest_list.php" style="text-decoration: none">STD Contests</a><br /><a href="http://code.hdu.edu.cn/vcontest" style="text-decoration: none">Virtual Contests </a><br/>&nbsp;&nbsp;<a href="/diy/contest_list.php" style="text-decoration: none">&nbsp;&nbsp;DIY | </a><a href="/webcontest" style="text-decoration: none"><font color="">Web-DIY</font> <font size=1 color="gray"><sup>beta</sup></font></a><br/><a style="text-decoration: none" href="/recentcontest">Recent Contests</a><br/>		</td>
		<td width=20%>
					<form method=post action="/userloginex.php?action=login">
			  <table width=168 border=0 align=center cellspacing=0>
			  	<tr><td align=center colspan=2><a href="/qqlogin/oauth/login.php"><img src="/qqlogin/images/qqlogin.png" border="0" /></a></td></tr>
				<tr><td width=68>Author ID&nbsp;</td><td align=right><input name=username type=text class=text90 maxlength=20></td></tr>
				<tr><td>Password&nbsp;</td><td align=right><input name=userpass type=password class=text90 maxlength=20></td></tr>
			  </table>
			  <input name=login type=submit class=button40 value="Sign In">&nbsp;<a href="http://bestcoder.hdu.edu.cn/register.php?url=acm.hdu.edu.cn/userloginex.php?action=login" style="text-decoration: none">Register new ID</a>
			</form>
						</td>
	</tr>
	</table>
	</td>
</tr>
<tr>
	<td>
		<div align=center id=rollword><marquee scrollamount=2 width=600 scrolldelay=30 onMouseOver="javascript:this.stop();" onMouseOut="javascript:this.start();"><b style="margin-right:20px"></b></marquee></div>	</td>
</tr>
<tr><td align=center><h1 style='color:#1A5CC8'>Hurry Up</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 5000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 125536/65536 K (Java/Others)<br>Total Submission(s): 268&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 29<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Now I'm in my school and I want to go back home as on time. However my bicycle has been stolen, which means I have to take buses. Let's consider the bus-net as a diagram. Vertices of the diagram (numbered 1, 2,..., N), correspond to stations, edges &lt;pi, pj&gt;(pi != pj), denote that there is a direct connections from the station pi to the station pj (1&lt;= pi, pj &lt;= N). Transportation lines are numbered 1, 2,..., K. The L-th transportation line is defined as a series of stations p<sub>L,1</sub>, p<sub>L,2</sub>,..., p<sub>L,sL</sub>, on which vehicles of the L-th line stop, and durations r<sub>L,1</sub>, r<sub>L,2</sub>,...,r<sub>L,sL-1</sub> of traveling between stations--- r<sub>L,1</sub> is the time necessary to get from the station p<sub>L,1</sub> to the station p<sub>L,2</sub>, or vice versa (i.e. from the station p<sub>L,2</sub> to the station p<sub>L,1</sub>); r<sub>L,2</sub> is the time necessary to get from the station p<sub>L,2</sub> to p<sub>L,3</sub>, etc. All the stations of a line are different (i.e. i != j, implies p<sub>L,i</sub> != p<sub>L,j</sub>). In the L-th transportation line, buses run with certain frequency c<sub>L</sub>, and c<sub>L</sub> is a number from the set {6, 10, 12, 15, 20, 30, and 60}. The buses in the L-th transportation line, start from the station p<sub>L,1</sub>  at each hour of the day and night, g:0, (0&lt;= g &lt;=23), and then according to the frequency of the line i.e. at g:cL, g:2cL,... etc. (g:c<sub>L</sub> means c<sub>L</sub> minutes after hour g). Buses of the L-th line run in two directions: from the station p<sub>L,1</sub> to p<sub>L,sL</sub>, and from the station p<sub>L,sL</sub> to p<sub>L,1</sub>. The hours of departure of the buses of the L-th transportation line from the station p<sub>L,sL</sub> are the same as from the station p<sub>L,1</sub>. In such a bus-net, we want to have a trip from the start station X which is near my school to the finish station Y which is near my home. During the trip one can change transportation lines, if he/she wants to. Say, the time of a change is equal to 0, however, while changing the line we have to take under consideration the time of waiting for the bus that we want to get into. Because of my poor memory, I can only change the line in no more than T (1&lt;= T &lt;= 20) times. And your task is to find a way from the start station X, to the finish station Y in W (0&lt;= W &lt;= 1440) minutes and change the lines as few as possible, if there are many ways to go back home and change the same least times of bus, choose the quickest one.<br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>In the first line there are written 8 integers, separated by single spaces:<br>N (1&lt;= N &lt;=200, number of stations), K (1&lt;= K &lt;=300, number of lines), X (1&lt;= X &lt;=N, the start station), Y (1&lt;= Y &lt;=N, X != Y, the finish station), GX (0&lt;= GX &lt;=23, the hour of the beginning of the trip), MX (0 &lt;= MX &lt;= 59, the minute of the beginning of the trip), W (0&lt;= W &lt;= 1440, the minute you must go back home within), T (1&lt;= T &lt;= 20, the times of changing line).<br><br>The stations are numbered from 1 to N, the transportation lines from 1 to K. In the following 3K lines the transportation lines are described - the description of each of them takes three consecutive lines.<br><br>In the first line describing the L-th transportation line, there are written two integers, separated by a single space: s<sub>L</sub>, the number of stations (2&lt;= s<sub>L</sub> &lt;=N), and c<sub>L</sub> - the frequency with which the vehicles run (c<sub>L</sub> belongs to: {6, 10, 12, 15, 20, 30, 60}).<br><br>In the second line describing the L-th transportation line, there are s<sub>L</sub> different integers, separated by single spaces: p<sub>L,1</sub>,p<sub>L,2</sub>,...,p<sub>L,sL</sub> --- the numbers of consecutive stations on the transportation line NO. L (1&lt;= p<sub>L,i</sub> &lt;=N, for 1&lt;= i &lt;=s<sub>L</sub>).In the third line describing the L-th transportation line, there are written s<sub>L</sub>-1 integers separated by single spaces: r<sub>L,1</sub>, r<sub>L,2</sub>,..., r<sub>L,sL-1</sub> --- the times (in minutes) necessary to go between the consecutive stations of this transportation line (1&lt;= r<sub>L,i</sub> &lt;=240, for 1&lt;= i &lt;=s<sub>L</sub>-1).<br>The total number of stations on all transportation lines is not greater than 4000 (i.e. s<sub>1</sub>+s<sub>2</sub>+...+s<sub>K</sub> &lt;= 4000).<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>Your program should write in the only line with three integers, separated by a single space: the least times you change the lines, the hour of the earliest possible arrival to the finish station GY (0&lt;= GY &lt;=23) and the minute of the earliest possible arrival to the finish station MY (0&lt;= MY &lt;=59). If I can't go back home within W minutes anyway, puts &quot;NO&quot; in a single line.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">6 2 5 6 23 30 1440 20
4 15
1 3 4 6
9 12 10
4 20
5 3 4 2
11 17 11</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1 0 16</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href="/search.php?field=problem&key=2011+Multi-University+Training+Contest+7+-+Host+by+ECNU&source=1&searchmode=source"> 2011 Multi-University Training Contest 7 - Host by ECNU </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>xubiao</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3904'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3904'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3904">Discuss</a> | <a href='note/note.php?pid=3904'>Note</a><br></td></tr><tr>
<td>
	<table style="border:#1A5CC8 1px solid; font-size:14px" cellSpacing=0 cellPadding=1 width=100%>
	<tr align=center>
		<td class=footer_link height=45><a href="/">Home</a> | <a href=#top>Top</a></td>
		<td style="padding:6px">
			Hangzhou Dianzi University Online Judge 3.0<br>
			Copyright &copy; 2005-2018 <a href=mailto:acm@hdu.edu.cn>HDU ACM Team</a>. All Rights Reserved.<br>
			<a href="../about_us/developer.php">Designer & Developer </a>: <a>Wang Rongtao</a>&nbsp<a>LinLe</a>&nbsp<a href=mailto:gjavac@gmail.com >GaoJie</a>&nbsp<a href=mailto:gl8997@gmail.com >GanLu</a><br>
			<span class=pagerunstatus>Total 0.015600(s) query 2, Server time : 2018-07-07 23:03:01, Gzip disabled</span>		</td>
		<td class=footer_link>
			<!-- <a href="javascript:history.go(-1);">Back</a> | <a href="javascript:history.forward();">Forward</a>-->
			<a href="/admin">Administration</a>	
		</td>
	</tr>
	</table>
</td>
</tr>
</table>
</body></html>
