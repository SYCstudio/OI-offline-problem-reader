<html><head><meta name=keywords content="HDOJ ACM ICPC OJ C C++ Pascal Java"><meta http-equiv=Content-Type content="text/html;charset=gb2312"><link rel=stylesheet type=text/css href="/images/global.css" media=all><link rel=stylesheet type=text/css href="/css/diyinhead.css" media=all><link rel=stylesheet type=text/css href="/css/webinhead.css" media=all><script src="/js/global.js" type=text/javascript></script><script src="/js/register.js" type=text/javascript></script><script src="/js/MathJax/MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><title>Problem - 4818</title></head><body >
<a name=top></a>
<table align=center cellSpacing=0 cellPadding=0 width=980 border=0 style="word-wrap:break-word">
<tr>
	<td style="border:#1A5CC8 1px solid" align=center width=100%>
		<a href="/">
			<img src="/images/banner.jpg" width="100%" height=116 border=0>
		</a>
	</td>
</tr>
<tr>
	<td style="border:#1A5CC8 1px solid">
	<table cellSpacing=0 cellPadding=1 width="979px">
	<tr bgcolor=#1A5CC8 align=center class=banner height=25>
		<td>Online Judge</td>
		<td>Online Exercise</td>
		<td>Online Teaching</td>
		<td>Online Contests</td>
	<td>Exercise Author</td>
	</tr>
	<tr style="font-size:16px" align=center>
		<td width=20% valign=top>
		<a href="/faq.php" style="text-decoration: none">F.A.Q</a><br>
		<a href="/friends" style="text-decoration: none">Hand In Hand</a><br>
		<a href="/onlineuser.php" style="text-decoration: none">Online Acmers</a>	<br>
		<!-- /onlineuser.php-->
		
		<a href="/forum" style="text-decoration: none">Forum | </a><a href="/discuss/public/list.php" style="text-decoration: none">Discuss</a><br>
		<a href="/statistic/submit_graph.php" style="text-decoration: none">Statistical Charts</a><br>
		</td>
		<td width=20% valign=top>
		<form action="/search.php" method=get>
		<a href="/listproblem.php?vol=1" style="text-decoration: none">Problem Archive</a><br/>
		<!--<a href="http://feeds.feedburner.com/Hdoj-problemset"><img src="/images/rss1.jpg" alt="problemset" style="vertical-align:text-bottom;"width=20 height=20></a><br>-->
		<!--
			 <a href="/submit.php">Submit Solution</a><br>
		-->	
		<a href="/status.php" style="text-decoration: none">Realtime Judge Status</a><br>

		<a href="/ranklist.php" style="text-decoration: none">Authors Ranklist</a><br>
		<input name=field value=author type=hidden><input class=text60 name=key>&nbsp;<input class=button40 type=submit value=Search>
		
		<!--
			<input name=field value=problem type=hidden><input class=text60 name=key>&nbsp;<input class=button40 type=submit value=Search>
		-->
		</form>
		</td>
		<td width=20% valign=top>
		 <form action='/search.php' method=get> 
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a style="text-decoration: none" href="http://code.hdu.edu.cn/">C/C++/Java Exams &nbsp;&nbsp;&nbsp;&nbsp;</a><br/>
		<a style="text-decoration: none" href="/game">ACM Steps</a><br/>
		<a href = "/ITJobs/">Go to Job</a><br/>	
		<a href="/livecast" style="text-decoration: none">Contest LiveCast</a><br/>
		<a style="text-decoration: none" href="/region">ICPC@China</a><br/>
		<!-- <a href="/register.php">Register New Author</a><br> -->
		<!-- <a href="/modifyuser.php">Update Your Information</a><br> -->
		</form>
		</td>
		<td width=20% valign=top>
		<a href="http://bestcoder.hdu.edu.cn" style="text-decoration: none; color: red; font-weight: bold;">Best Coder <sup style="color: gray;">beta</sup></a><br/><a href="/vip/contest_list.php" style="text-decoration: none">VIP</a> | <a href="/contests/contest_list.php" style="text-decoration: none">STD Contests</a><br /><a href="http://code.hdu.edu.cn/vcontest" style="text-decoration: none">Virtual Contests </a><br/>&nbsp;&nbsp;<a href="/diy/contest_list.php" style="text-decoration: none">&nbsp;&nbsp;DIY | </a><a href="/webcontest" style="text-decoration: none"><font color="">Web-DIY</font> <font size=1 color="gray"><sup>beta</sup></font></a><br/><a style="text-decoration: none" href="/recentcontest">Recent Contests</a><br/>		</td>
		<td width=20%>
					<form method=post action="/userloginex.php?action=login">
			  <table width=168 border=0 align=center cellspacing=0>
			  	<tr><td align=center colspan=2><a href="/qqlogin/oauth/login.php"><img src="/qqlogin/images/qqlogin.png" border="0" /></a></td></tr>
				<tr><td width=68>Author ID&nbsp;</td><td align=right><input name=username type=text class=text90 maxlength=20></td></tr>
				<tr><td>Password&nbsp;</td><td align=right><input name=userpass type=password class=text90 maxlength=20></td></tr>
			  </table>
			  <input name=login type=submit class=button40 value="Sign In">&nbsp;<a href="http://bestcoder.hdu.edu.cn/register.php?url=acm.hdu.edu.cn/userloginex.php?action=login" style="text-decoration: none">Register new ID</a>
			</form>
						</td>
	</tr>
	</table>
	</td>
</tr>
<tr>
	<td>
		<div align=center id=rollword><marquee scrollamount=2 width=600 scrolldelay=30 onMouseOver="javascript:this.stop();" onMouseOut="javascript:this.start();"><b style="margin-right:20px"></b></marquee></div>	</td>
</tr>
<tr><td align=center><h1 style='color:#1A5CC8'>RP problem</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 890&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 264<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>&nbsp;&nbsp;As an ACMer, you must have heard of the legend of Ren Pin (RP), which means a person’s lucky degree. Neither can RP be created, nor eliminated without foundation. It can only be transferred from one person to another. Moreover, everyone has his social circle. It’s guaranteed that each person has at least one friend and he cannot be the friend of himself. The relationship is directed. In RP system, one’s RP is transferred from himself to all of his friends uniformly every day. For example, A has three friends, B, C and D and his current RP is 1. In tomorrow, 1/3 of his RP will be transferred to B, 1/3 to C and 1/3 to D and RP from those treat him as friends will be transferred to him as well.<br><br>&nbsp;&nbsp;On the other hand, the god in charge of the RP system is tired of the transferring RP from one person to another every day. Making the assumption that the total amount of RP is 1, he wants to know whether there is a stable distribution in RP system, so that by reallocating the RP of each person, he can lighten his workload. Stable distribution means if the structure of social network keeps unchanged, no matter how many days pass by, everyone’s RP keeps unchanged. You will see an example as follows. For the ease of presentation, let “X-&gt;Y” denotes X takes Y as his friend. There are only three persons A, B and C in the world with A-&gt;B, B-&gt;C, C-&gt;A and C-&gt;B. If the current RPs of A, B, C are 0.2, 0.4, 0.4 respectively, then the RPs will still be 0.2, 0.4, 0.4 in tomorrow. It’s obviously that the distribution keeps unchanged no matter how many days pass by, so (0.2, 0.4, 0.4) is a stable distribution. However, if the current RPs of A, B, C are 0.3, 0.3, 0.4, respectively, then the RPs will be 0.2, 0.5, 0.3 in tomorrow, so (0.3, 0.3, 0.4) is not a stable distribution. The god wonders, for a given a social network, how many stable distributions exist?<br><br>&nbsp;&nbsp;Furthermore, if there is one and only one stable distribution, your friend A, who is lack of luck, wants to know whether he can increase his RP by making one more new friend. More specifically, letting RP(A, G) be the RP of A in the stable distribution for a network G, the RP of A after adding A-&gt;X to G is RP(A, G \/ {A-&gt;X}). Your friend A wants to know if there exists a person X, such that RP(A, G \/ {A-&gt;X}) is strictly larger than RP(A, G). For example, there are four persons A, B, C, D in the world with A-&gt;B, B-&gt;C, C-&gt;A, D-&gt;A. The only one stable distribution is (1/3, 1/3, 1/3, 0). If A-&gt;D is added to the network, the stable distribution will be (2/5, 1/5, 1/5, 1/5) and 2/5 &gt; 1/3, so A can increase his RP by making friend with D. If there are multiple qualifying persons, your friend A wants to know which one can increase his RP to the maximum extent.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line of input contains an integer T (T ≤ 50) indicating the number of datasets. Each dataset starts with two integers n and m (n ≤ 100, n ≤ m ≤ n*(n-1)), where n and m indicate the number of persons and the number of relationships, respectively. Next m lines describe the relationships in the social network. Each of these lines will contain two integers u and v (0 ≤ u, v &lt; n), indicating u-&gt;v.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output a single line. If the number of stable distributions is infinite, print “INF”, otherwise, print the number of stable distributions. If there is only one stable distribution, print the person whom your friend A can increase the most RP by making friend with. If there exists multiple such persons, print the one with the smallest ID. However, if no person satisfies the requirement, print “-1”.<br><br>Your friend A’s ID is always (n-1).</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3
4 4
0 1
1 0
2 3
3 2
3 3
0 1
1 2
2 0
3 3
0 1
1 0
2 1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">INF
1 1
1 -1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href="/search.php?field=problem&key=2013+Asia+Regional+Changchun+&source=1&searchmode=source"> 2013 Asia Regional Changchun  </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>liuyiding</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=4818'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=4818'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=4818">Discuss</a> | <a href='note/note.php?pid=4818'>Note</a><br></td></tr><tr>
<td>
	<table style="border:#1A5CC8 1px solid; font-size:14px" cellSpacing=0 cellPadding=1 width=100%>
	<tr align=center>
		<td class=footer_link height=45><a href="/">Home</a> | <a href=#top>Top</a></td>
		<td style="padding:6px">
			Hangzhou Dianzi University Online Judge 3.0<br>
			Copyright &copy; 2005-2018 <a href=mailto:acm@hdu.edu.cn>HDU ACM Team</a>. All Rights Reserved.<br>
			<a href="../about_us/developer.php">Designer & Developer </a>: <a>Wang Rongtao</a>&nbsp<a>LinLe</a>&nbsp<a href=mailto:gjavac@gmail.com >GaoJie</a>&nbsp<a href=mailto:gl8997@gmail.com >GanLu</a><br>
			<span class=pagerunstatus>Total 0.015600(s) query 2, Server time : 2018-07-08 00:10:02, Gzip disabled</span>		</td>
		<td class=footer_link>
			<!-- <a href="javascript:history.go(-1);">Back</a> | <a href="javascript:history.forward();">Forward</a>-->
			<a href="/admin">Administration</a>	
		</td>
	</tr>
	</table>
</td>
</tr>
</table>
</body></html>
