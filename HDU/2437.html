<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Jerboas</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU2437. Jerboas</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：5000/1000 MS (Java/Others)</span> <span class="ui label">时间限制：32768/32768 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jerboas are small desert-living animals, which resemble mice with a long tufted tail and very long hind legs. Jerboas shelter in well-hidden burrows. They create two types of burrow: temporary and permanent. The temporary burrows are plain tubes while the permanent burrows are sealed with a plug of sand to keep heat out and moisture in. <br><br><center> <img style='max-width:100%;' src=./data/images/C143-1010-1.jpg></center> <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As far as we know, jerboa burrows in the desert are connected with one-way tunnels. What's more, for some unknown reasons, it's true that start from any burrow, follows the tunnels you can not go back to the starting burrow.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Summer means last-minute of offers on good times, so of course jerboas could not stay behind. One day, a little jerboa Alice who lived in a temporary burrow S wants to migrate to a permanent one. There are different routes she can take, but Alice is so odd that she only selects those whose total travel distances is a multiple of K. Among all routes that Alice may select, we are interested in the shortest one. Can you help to find it out?  Of course different routes may lead to different destinations.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On the first line of input, there is a single positive integer T &lt;= 20 specifying the number of test cases to follow. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Each test case starts with four integers in the first line: N, M, S, K. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N is the number of burrows in the desert (burrows are numbered with 1, 2, …, N); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M is the number of tunnels connecting the burrows; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S is where Alice lived and K is as described above. <br>(0 &lt; N &lt;= 1000, 0 &lt;= M &lt;= 20000, 0 &lt; S &lt;= N, 0 &lt; K &lt;= 1000)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The second line contains N characters each could be ‘T’ or ‘P’. The i-th character specifying the type of the burrow i. ‘T’ means temporary burrow, ‘P’ means permanent burrow. It’s guaranteed that the S-th character is ‘T’.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next follow M lines, each line with 3 integers A, B, C. Specifying that there is a tunnel from burrow A to burrow B, and its length is C. <br>(0 &lt; A, B &lt;= N, A != B, 0 &lt; C &lt; 40000)<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For each test case you should output a single line containing &quot;Case X: Y Z&quot; (quotes for clarity) where X is the number of the test case (starting at 1) and Y is the length of the shortest route Alice can select and Z is the destination of the selected route.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notice that burrow Z should be a permanent burrow.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In case there’s more than one solution, Z should be the minimum. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In case there's no solution, Y and Z should be both equal to -1.<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">2
5 5 1 7
TPPTP
1 2 8
1 4 7
4 3 9
2 3 6
1 5 3
5 5 1 7
TPTTP
1 2 8
1 4 7
4 3 9
2 3 6
1 5 3</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">Case 1: 14 3
Case 2: -1 -1</div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2008+Asia+Chengdu+Regional+Contest+Online&source=1&searchmode=source"> 2008 Asia Chengdu Regional Contest Online </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>