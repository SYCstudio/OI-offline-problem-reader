<html><head><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>Wow! Such City!</title></head><body><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">HDU4849. Wow! Such City!</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：15000/8000 MS (Java/Others)</span> <span class="ui label">时间限制：102400/102400 K (Java/Others)</span></div></div></br><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">   Doge, tired of being a popular image on internet, is considering moving to another city for a new way of life.<br>   In his country there are N (2 ≤N≤ 1000) cities labeled 0 . . . N - 1. He is currently in city 0. Meanwhile, for each pair of cities, there exists a road connecting them, costing C<sub>i</sub>,<sub>j</sub> (a positive integer) for traveling from city i to city j. Please note that C<sub>i</sub>,<sub>j</sub> may not equal to C<sub>j</sub>,<sub>i</sub> for any given i ≠ j.<br>   Doge is carefully examining the cities: in fact he will divide cities (his current city 0 is <b>NOT</b> included) into M (2 ≤ M ≤ 10<sup>6</sup>) categories as follow:  If the minimal cost from his current city (labeled 0) to the city i is Di, city i belongs to category numbered <b>D<sub>i</sub> mod M</b>.Doge wants to know the “minimal” category (a category with minimal number) which contains at least one city.<br>   For example, for a country with 4 cities (labeled 0 . . . 3, note that city 0 is not considered), Doge wants to divide them into 3 categories.  Suppose category 0 contains no city, category 1 contains city 2 and 3, while category 2 contains city 1, Doge consider category 1 as the minimal one.<br>   Could you please help Doge solve this problem?<br><br>Note:<br><br>   C<sub>i</sub>,<sub>j</sub> is generated in the following way:<br>   Given integers X<sub>0</sub>, X<sub>1</sub>, Y<sub>0</sub>, Y<sub>1</sub>, (1 ≤  X<sub>0</sub>, X<sub>1</sub>, Y<sub>0</sub>, Y<sub>1</sub>≤ 1234567), for k ≥ 2 we have<br>   Xk&nbsp;&nbsp;=  (12345 + X<sub>k-1</sub> * 23456 + X<sub>k-2</sub> * 34567 + X<sub>k-1</sub> * X<sub>k-2</sub> * 45678)&nbsp;&nbsp;mod&nbsp;&nbsp;5837501<br>   Yk&nbsp;&nbsp;=  (56789 + Y<sub>k-1</sub> * 67890 + Y<sub>k-2</sub> * 78901 + Y<sub>k-1</sub> * Y<sub>k-2</sub> * 89012)&nbsp;&nbsp;mod&nbsp;&nbsp;9860381<br>The for k ≥ 0 we have<br><br>                  Z<sub>k</sub> = (X<sub>k</sub> * 90123 + Y<sub>k</sub> ) mod 8475871 + 1<br><br>Finally for 0 ≤ i, j ≤ N - 1 we have<br><br>                  C<sub>i</sub>,<sub>j</sub> = Z<sub>i*n+j</sub>    for  i ≠ j<br>                  C<sub>i</sub>,<sub>j</sub> = 0&nbsp;&nbsp;     for  i = j<br></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">   There are several test cases. Please process till EOF.<br>   For each test case, there is only one line containing 6 integers N,M,X<sub>0</sub>,X<sub>1</sub>,Y<sub>0</sub>,Y<sub>1</sub>.See the description for more details.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">   For each test case, output a single line containing a single integer: the number of minimal category.</div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">3 10 1 2 3 4
4 20 2 3 4 5</code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">1
10

For the first test case, we have


   0   1   2   3   4   5   6   7   8
X   1   2 185180 7889971483212465942341237382178800 219267
Y   3   4163319678455642071599456269735239123177371167849
Z 90127 18025116203382064506 6251355664774564795082825524912390

the cost matrix C is
            0 1802511620338
                2064506   05664774
                56479508282552   0

<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>So the minimal cost from city 0 to city 1 is 180251, while the distance to city 2 is 1620338.
Given M = 10, city 1 and city 2 belong to category 1 and 8 respectively.
Since only category 1 and 8 contain at least one city,
the minimal one of them, category 1, is the desired answer to Doge’s question.</div><i style='font-size:1px'> </i></div></code></pre></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"> <a href="/search.php?field=problem&key=2014%CE%F7%B0%B2%C8%AB%B9%FA%D1%FB%C7%EB%C8%FC&source=1&searchmode=source"> 2014西安全国邀请赛 </a> </div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">OI-offline-problem-reader Powered by <a href="http://www.sycstudio.com">SYCstudio</a>.</span></div></div></div></body></html>